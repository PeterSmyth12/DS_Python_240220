<!DOCTYPE html><html><head>
      <title>contents</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
      
      

      
      
      
      
      
      
      

      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}

/* highlight */
pre[data-line] {
  position: relative;
  padding: 1em 0 1em 3em;
}
pre[data-line] .line-highlight-wrapper {
  position: absolute;
  top: 0;
  left: 0;
  background-color: transparent;
  display: block;
  width: 100%;
}

pre[data-line] .line-highlight {
  position: absolute;
  left: 0;
  right: 0;
  padding: inherit 0;
  margin-top: 1em;
  background: hsla(24, 20%, 50%,.08);
  background: linear-gradient(to right, hsla(24, 20%, 50%,.1) 70%, hsla(24, 20%, 50%,0));
  pointer-events: none;
  line-height: inherit;
  white-space: pre;
}

pre[data-line] .line-highlight:before, 
pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-start);
  position: absolute;
  top: .4em;
  left: .6em;
  min-width: 1em;
  padding: 0 .5em;
  background-color: hsla(24, 20%, 50%,.4);
  color: hsl(24, 20%, 95%);
  font: bold 65%/1.5 sans-serif;
  text-align: center;
  vertical-align: .3em;
  border-radius: 999px;
  text-shadow: none;
  box-shadow: 0 1px white;
}

pre[data-line] .line-highlight[data-end]:after {
  content: attr(data-end);
  top: auto;
  bottom: .4em;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview  ">
      <h2 class="mume-header" id="introducing-the-python-programming-language">Introducing the Python programming language</h2>

<p>Python is a general purpose programming language. It is an interpreted language, which makes it suitable for rapid development and prototyping of programming segments or complete small programs.</p>
<p>Python&apos;s main advantages:</p>
<ul>
<li>Open source software, supported by <a href="https://www.python.org/psf/">Python Software Foundation</a></li>
<li>Available on all major platforms (Windows, macOS, Linux)</li>
<li>It is a good language for new programmers to learn due to its straightforward, object-oriented style</li>
<li>It is well-structured, which aids readability</li>
<li>It is extensible (i.e. modifiable) and is supported by a large community who provide a comprehensive range of 3rd party packages</li>
</ul>
<h2 class="mume-header" id="interpreted-vs-compiled-languages">Interpreted vs. compiled languages</h2>

<p>In any programming language, the code must be translated into &quot;machine code&quot; before running it. It is the machine code which is executed and produces results. In a language like C++ your code is translated into machine code and stored in a separate file, in a process referred to as <strong>compiling</strong> the code. You then execute the machine code from the file as a separate step. This is efficient if you intend to run the same machine code many times as you only have to compile it once and it is very fast to run the compiled machine code.</p>
<p>On the other hand, if you are experimenting, then your code will change often and you would have to compile it again every time before the machine can execute it. This is where <strong>interpreted</strong> languages have the advantage. You don&apos;t need a complete compiled program to &quot;run&quot; what has been written so far and see the results. This rapid prototyping is helped further by use of a system called REPL.</p>
<h2 class="mume-header" id="repl">REPL</h2>

<p><strong>REPL</strong> is an acronym which stands for Read, Evaluate, Print and Loop.</p>
<p>REPL allows you to write single statements of code, have them executed, and if there are any results to show, they are displayed and then the interpreter loops back to the beginning and waits for the next program statement.</p>
<p><img src="./fig/Python_repl_3.png" alt="Python_Repl"></p>
<p>In the example above, two variables <code>a</code> and <code>b</code> have been created, assigned to values <code>2</code> and <code>3</code>, and then multiplied together.</p>
<p>Every time you press <kbd>Return</kbd>, the line is interpreted. The assignment statements don&apos;t produce any output so you get only the standard <code>&gt;&gt;&gt;</code> prompt.</p>
<p>For the <code>a*b</code> statement (it is more of an expression than a statement), because the result is not being assigned to a variable, the REPL displays the result of the calculation on screen and then waits for the next input.</p>
<p>The REPL system makes it very easy to try out small chunks of code.</p>
<p>You are not restricted to single line statements. If the Python interpreter decides that what you have written on a line cannot be a complete statement it will give you a continuation prompt of <code>...</code> until you complete the statement.</p>
<h2 class="mume-header" id="introducing-jupyter-notebooks">Introducing Jupyter notebooks</h2>

<p><a href="http://jupyter.org/"><strong>Jupyter</strong></a> originates from IPython, an effort to make Python development more interactive. Since its inception, the scope of the project has expanded to include <strong>Ju</strong>lia, <strong>Pyt</strong>hon, and <strong>R</strong>, so the name was changed to &quot;Jupyter&quot; as a reference to these core languages. Today, Jupyter supports even more languages, but we will be using it only for Python code. Specifically, we will<br>
be using <strong>Jupyter notebooks</strong>, which allows us to easily take notes about our analysis and view plots within the same document where we code. This facilitates sharing and reproducibility of analyses, and the notebook interface is easily accessible through any web browser. Jupyter notebooks are started from the terminal using</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash">$ jupyter notebook
</pre><p>If you have a later version of Jupyter, you can also use</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash">$ jupyter lab
</pre><p>The underlying notebooks in Jupyter lab work exactly the same way as they do in the original notebooks (they have the same file extension) but Jupyter lab is a richer environment adding several useful tools for a developer, like a file viewer.</p>
<p>Your browser should start automatically and look<br>
something like this:</p>
<p><img src="./fig/Python_jupyter_6.png" alt="Jupyter_notebook_list"></p>
<p>When you create a notebook from the <em>New</em> option, the new notebook will be displayed in a new browser tab and look like this.</p>
<p><img src="./fig/Python_jupyter_7.png" alt="Jupyter_notebook"></p>
<p>Initially the notebook has no name other than &apos;Untitled&apos;. If you click on &apos;Untitled&apos; you will be given the option of changing the name to whatever you want.</p>
<p>The notebook is divided into <strong>cells</strong>. Initially there will be a single input cell marked by <code>In [ ]:</code>.</p>
<p>You can type Python code directly into the cell. You can split the code across several lines as needed. Unlike the REPL we looked at before, the code is not interpreted line by line. To interpret the code in a cell, you can click the <em>Run</em> button in the toolbar or from the <em>Cell</em> menu option, or use keyboard shortcuts (e.g., <kbd>Shift</kbd>+<kbd>Return</kbd>). All of the code in that cell will then be executed.</p>
<p>The results are shown in a separate <code>Out [1]:</code> cell immediately below. A new input cell (<code>In [ ]:</code>) is created for you automatically.</p>
<p><img src="./fig/Python_jupyter_8.png" alt="Jupyter_notebook_cell"></p>
<p>When a cell is run, it is given a number along with the corresponding output cell. If you have a notebook with many cells in it you can run the cells in any order and also run the same cell many times. The number on the left hand side of the input cells increments, so you can always tell the order in which they were run. For example, a cell marked <code>In [5]:</code> was the fifth cell run in the sequence.</p>
<p>Although there is an option to do so on the toolbar, you do not have to manually save the notebook. This is done automatically by the Jupyter system.</p>
<p>Not only are the contents of the <code>In [ ]:</code> cells saved, but so are the <code>Out [ ]:</code> cells. This allows you to create complete documents with both your code and the output of the code in a single place.  You can also change the cell type from Python code to Markdown using the <em>Cell &gt; Cell Type</em> option.  <a href="https://en.wikipedia.org/wiki/Markdown"><strong>Markdown</strong></a> is a simple formatting system which allows you to create documentation for your code, again all within the same notebook structure.</p>
<p>The notebook itself is stored as specially-formatted text file with an <code>.ipynb</code> extension. These files can be opened and run by others with Jupyter installed. This allows you to share your code inputs, outputs, and Markdown documentation with others. You can also export the notebook to HTML, PDF, and many other formats to make sharing even easier.</p>
<h2 class="mume-header" id="using-the-jupyter-environment">Using the Jupyter environment</h2>

<h3 class="mume-header" id="new-cells">New cells</h3>

<p>From the insert menu item you can insert a new cell anywhere in the notebook either above or below the current cell. You can also use the <code>+</code> button on the toolbar to insert a new cell below.</p>
<h3 class="mume-header" id="change-cell-type">Change cell type</h3>

<p>By default new cells are created as code cells. From the cell menu item you can change the type of a cell from code to markdown. Markdown is a markup language for formatting text, it has much of the power of HTML, but is specifically designed to be human-readable as well. You can use Markdown cells to insert formatted textual explanation and analysis into your notebook. For more information about Markdown, check out these resources:</p>
<ul>
<li><a href="http://jupyter-notebook.readthedocs.io/en/stable/examples/Notebook/Working%20With%20Markdown%20Cells.html">Jupyter Notebook Markdown Docs</a></li>
<li><a href="https://beegit.com/markdown-cheat-sheet">Markdown - a Visual Guide</a></li>
<li><a href="https://guides.github.com/features/mastering-markdown/">Mastering Markdown from Github</a></li>
<li><a href="https://daringfireball.net/projects/markdown/">Markdown official open source project</a></li>
</ul>
<h3 class="mume-header" id="hiding-output">Hiding output</h3>

<p>When you run cells of code the output is displayed immediately below the cell. In general this is convenient. The output is associated with the cell that produced it and remains a part of the notebook. So if you copy or move the notebook the output stays with the code.</p>
<p>However lots of output can make the notebook look cluttered and more difficult to move around. So there is an option available from the <code>cell</code> menu item to &apos;toggle&apos; or &apos;clear&apos; the output associated either with an individual cell or all cells in the notebook.</p>
<h2 class="mume-header" id="creating-variables-and-assigning-values">Creating variables and assigning values</h2>

<h3 class="mume-header" id="variables-and-types">Variables and Types</h3>

<p>In Python variables are created when you first assign values to them.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">a <span class="token operator">=</span> <span class="token number">2</span>
b <span class="token operator">=</span> <span class="token number">3.142</span>
</pre><p>All variables have a data type associated with them. The data type is an indication of the type of data contained in a variable. If you want to know the type of a variable you can use the built-in <code>type()</code> function.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
s <span class="token operator">=</span> <span class="token string">&quot;Hello World&quot;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>&lt;class &apos;int&apos;&gt;
&lt;class &apos;float&apos;&gt;
&lt;class &apos;str&apos;&gt;
</code></pre><p>There are many more data types available, a full list is available in the <a href="https://docs.python.org/3/library/datatypes.html">Python documentation</a>. We will be looking a few of them later on.</p>
<h2 class="mume-header" id="arithmetic-operations">Arithmetic operations</h2>

<p>For now we will stick with the numeric types and do some arithmetic.</p>
<p>All of the usual arithmetic operators are available.</p>
<p>In the examples below we also introduce the Python comment symbol <code>#</code>.<br>
Anything to the right of the <code>#</code> symbol is treated as a comment. To a large extent using Markdown cells in a notebook reduces the need for comments in the code in a notebook, but occasionally they can be useful.</p>
<p>We also make use of the built-in <code>print()</code> function, which displays formatted text.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;a =&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> <span class="token string">&quot;and b =&quot;</span> <span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a <span class="token operator">+</span> b<span class="token punctuation">)</span>      <span class="token comment"># addition</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a <span class="token operator">*</span> b<span class="token punctuation">)</span>      <span class="token comment"># multiplication</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a <span class="token operator">-</span> b<span class="token punctuation">)</span>      <span class="token comment"># subtraction</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a <span class="token operator">/</span> b<span class="token punctuation">)</span>      <span class="token comment"># division</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>b <span class="token operator">**</span> a<span class="token punctuation">)</span>     <span class="token comment"># exponentiation</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">*</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span>  <span class="token comment"># modulus - returns the remainder</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>a = 2 and b = 3.142
5.1419999999999995
6.284
-1.142
0.6365372374283896
9.872164
0.8580000000000001
</code></pre><p>We need to use the <code>print()</code> function because by default only the last output from a cell is displayed in the output cell.</p>
<p>In our example above, we pass four different parameters to the first call of <code>print()</code>, each separated by a comma. A string <code>&quot;a = &quot;</code>, followed by the variable <code>a</code>, followed by the string <code>&quot;b = &quot;</code> and then the variable <code>b</code>.</p>
<p>The output is what you would probably have guessed at.</p>
<p>All of the other calls to <code>print()</code> are only passed a single parameter. Although it may look like 2 or 3, the expressions are evaluated first and it is only the single result which is seen as the parameter value and printed.</p>
<p>In the last expression <code>a</code> is multiplied by 2 and then the modulus of the result is taken. Had I wanted to calculate a % b and then multiply the result by two I could have done so by using brackets to make the order of calculation clear.</p>
<p>Arithmetic expressions can be arbitrarily complex, but remember people have to read and understand them as well.</p>
<h2>Exercise</h2>
<ol>
<li>
<p>Create a new cell and paste into it the assignments to the variables a and b and the contents of the code cell above with all of the print statements. Remove all of the calls to the print function so you only have the expressions that were to be printed and run the code. What is returned?</p>
</li>
<li>
<p>Now remove all but the first line (with the 4 items in it) and run the cell again. How does this output differ from when we used the print function?</p>
</li>
<li>
<p>Practice assigning values to variables using as many different operators as you can think of.</p>
</li>
<li>
<p>Create some expressions to be evaluated using parentheses to enforce the order of mathematical operations that you require</p>
</li>
</ol>
 <details><summary><b>Solution</b>  - click me</summary>
<ol>
<li>Only the last result is printed.</li>
<li>The 4 &apos;items&apos; are printed by the REPL, but not in the same way as the print statement. The items in quotes are treated as separate strings, for the variables a and b the values are printed. All four items are treated as a &apos;tuple&apos; which are shown in parentheses, a tuple is another data type in Python that allows you to group things together and treat as a unit. We can tell that it is a tuple because of the <code>()</code></li>
</ol>
<p>A complete set of Python operators can be found in the <a href="https://docs.python.org/3.5/library/operator.html">official documentation</a> . The documentation may appear a bit confusing as it initially talks about operators as functions whereas we generally use them as &apos;in place&apos; operators. Section 10.3.1 provides a table which list all of the available operators, not all of which are relevant to basic arithmetic.</p>
</details>
<br>
<h2 class="mume-header" id="using-built-in-functions">Using built-in functions</h2>

<p>Python has a reasonable number of built-in functions. You can find a complete list in the <a href="https://docs.python.org/3/library/functions.html">official documentation</a>.</p>
<p>Additional functions are provided by 3rd party packages which we will look at later on.</p>
<p>For any function, a common question to ask is: What parameters does this function take?</p>
<p>In order to answer this from Jupyter, you can type the function name and then type <code>shift</code>+<code>tab</code> and a pop-up window will provide you with various details about the function including the parameters.</p>
<h2 class="mume-header" id="exercise">Exercise</h2>

<p>For the <code>print()</code> function find out what parameters can be provided</p>
<details><summary><b>Solution</b>  - click me</summary>
<p>Type &apos;print&apos; into a code cell and then type <code>shift</code>+<code>tab</code>. The following pop-up should appear.</p>
<p><img src="./fig/Python_function_parameters_9.png" alt="Print parameter information"></p>
</details>
<br>
<h2 class="mume-header" id="getting-help-for-python">Getting Help for Python</h2>

<p>You can get help on any Python function by using the help function. It takes a single parameter of the function name for which you want the help</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token builtin">help</span><span class="token punctuation">(</span><span class="token keyword">print</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>Help on built-in function print in module builtins:

print(...)
    print(value, ..., sep=&apos; &apos;, end=&apos;\n&apos;, file=sys.stdout, flush=False)

    Prints the values to a stream, or to sys.stdout by default.
    Optional keyword arguments:
    file:  a file-like object (stream); defaults to the current sys.stdout.
    sep:   string inserted between values, default a space.
    end:   string appended after the last value, default a newline.
    flush: whether to forcibly flush the stream.
</code></pre><p>There is a great deal of Python help and information as well as code examples available from the internet.  One popular site is <a href="https://stackoverflow.com/tags">stackoverflow</a> which specialises in providing programming help. They have dedicated forums not only for Python but also for many of the popular 3rd party Python packages. They also always provide code examples to illustrate answers to questions.</p>
<p>You can also get answers to your queries by simply inputting your question (or selected keywords) into any search engine.</p>
<p>A couple of things you may need to be wary of: There are currently 2 versions of Python in use, in most cases code examples will run in either but there are some exceptions. Secondly, some replies may assume a knowledge of Python beyond your own, making the answers difficult to follow. But for any given question there will be a whole range of suggested solutions so you can always move on to the next.</p>
<h2 class="mume-header" id="data-types-and-how-python-uses-them">Data types and how Python uses them</h2>

<h3 class="mume-header" id="changing-data-types">Changing data types</h3>

<p>The  data type of a variable is assigned when you give a variable a value as we did above. If you re-assign the value of a variable, you can change the data type.</p>
<p>You can also explicitly change the type of a variable by <code>casting</code> it using an appropriate Python builtin function. In this example we have changed a <code>string</code> to a <code>float</code>.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">a <span class="token operator">=</span> <span class="token string">&quot;3.142&quot;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
a <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>&lt;class &apos;str&apos;&gt;
&lt;class &apos;float&apos;&gt;
</code></pre><p>Although you can always change an <code>integer</code> to a <code>float</code>, if you change a <code>float</code> to an <code>integer</code> then you can lose part of the value of the variable and you won&apos;t get an error message.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">a <span class="token operator">=</span> <span class="token number">3.142</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
a <span class="token operator">=</span> <span class="token number">3</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
a <span class="token operator">=</span> a<span class="token operator">*</span><span class="token number">1.0</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
a <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
a <span class="token operator">=</span> <span class="token number">3.142</span>
a <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>&lt;class &apos;float&apos;&gt;
&lt;class &apos;int&apos;&gt;
&lt;class &apos;float&apos;&gt;
&lt;class &apos;int&apos;&gt;
&lt;class &apos;int&apos;&gt;
3
</code></pre><p>In some circumstances explicitly converting a data type makes no sense; you cannot change a string with alphabetic characters into a number.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">b <span class="token operator">=</span> <span class="token string">&quot;Hello World&quot;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>

b <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>&lt;class &apos;str&apos;&gt;
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
&lt;ipython-input-8-9f5f81a470f9&gt; in &lt;module&gt;()
      2 print(type(b))
      3
----&gt; 4 b = int(b)
      5 print(type(b))

ValueError: invalid literal for int() with base 10: &apos;Hello World&apos;
</code></pre><h2 class="mume-header" id="strings">Strings</h2>

<p>A string is a simple data type which holds a sequence of characters.</p>
<p>Strings are placed in quotes when they are being assigned, but the quotes don&apos;t count as part of the string value.</p>
<p>If you need to use quotes as part of your string you can arbitrarily use either single of double quotes to indicate the start and end of the string.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">mystring <span class="token operator">=</span> <span class="token string">&quot;Hello World&quot;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mystring<span class="token punctuation">)</span>

name <span class="token operator">=</span> <span class="token string">&quot;Peter&quot;</span>
mystring <span class="token operator">=</span> <span class="token string">&apos;Hello &apos;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">&apos; How are you?&apos;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mystring<span class="token punctuation">)</span>

name <span class="token operator">=</span> <span class="token string">&quot;Peter&quot;</span>
mystring <span class="token operator">=</span> <span class="token string">&apos;Hello this is &apos;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">&quot;&apos;s code&quot;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mystring<span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>Hello World
Hello Peter How are you?
Hello this is Peter&apos;s code
</code></pre><h2 class="mume-header" id="string-functions">String functions</h2>

<p>There are a variety of Python functions available for use with strings. In Python a string is an object. An object put simply is something which has <code>data</code>, in the case of our string it is the contents of the string and <code>methods</code>. <code>methods</code> is another way of saying <code>functions</code>.</p>
<p>Although <code>methods</code> and <code>functions</code> are very similar in practice, there is a difference in the way you call them.</p>
<p>One typical bit of information you might want to know about a string is its length for this we use the <code>len()</code> function. For almost anything else you might want to do with strings, there is a method.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">mystring <span class="token operator">=</span> <span class="token string">&quot;Hello World&quot;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>mystring<span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>11
</code></pre><p>If you want to see a list of all of the available methods for a string (or any other object) you can use the <code>dir()</code> function.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">dir</span><span class="token punctuation">(</span>mystring<span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>[&apos;__add__&apos;, &apos;__class__&apos;, &apos;__contains__&apos;, &apos;__delattr__&apos;, &apos;__dir__&apos;, &apos;__doc__&apos;, &apos;__eq__&apos;, &apos;__format__&apos;, &apos;__ge__&apos;, &apos;__getattribute__&apos;, &apos;__getitem__&apos;, &apos;__getnewargs__&apos;, &apos;__gt__&apos;, &apos;__hash__&apos;, &apos;__init__&apos;, &apos;__iter__&apos;, &apos;__le__&apos;, &apos;__len__&apos;, &apos;__lt__&apos;, &apos;__mod__&apos;, &apos;__mul__&apos;, &apos;__ne__&apos;, &apos;__new__&apos;, &apos;__reduce__&apos;, &apos;__reduce_ex__&apos;, &apos;__repr__&apos;, &apos;__rmod__&apos;, &apos;__rmul__&apos;, &apos;__setattr__&apos;, &apos;__sizeof__&apos;, &apos;__str__&apos;, &apos;__subclasshook__&apos;, &apos;capitalize&apos;, &apos;casefold&apos;, &apos;center&apos;, &apos;count&apos;, &apos;encode&apos;, &apos;endswith&apos;, &apos;expandtabs&apos;, &apos;find&apos;, &apos;format&apos;, &apos;format_map&apos;, &apos;index&apos;, &apos;isalnum&apos;, &apos;isalpha&apos;, &apos;isdecimal&apos;, &apos;isdigit&apos;, &apos;isidentifier&apos;, &apos;islower&apos;, &apos;isnumeric&apos;, &apos;isprintable&apos;, &apos;isspace&apos;, &apos;istitle&apos;, &apos;isupper&apos;, &apos;join&apos;, &apos;ljust&apos;, &apos;lower&apos;, &apos;lstrip&apos;, &apos;maketrans&apos;, &apos;partition&apos;, &apos;replace&apos;, &apos;rfind&apos;, &apos;rindex&apos;, &apos;rjust&apos;, &apos;rpartition&apos;, &apos;rsplit&apos;, &apos;rstrip&apos;, &apos;split&apos;, &apos;splitlines&apos;, &apos;startswith&apos;, &apos;strip&apos;, &apos;swapcase&apos;, &apos;title&apos;, &apos;translate&apos;, &apos;upper&apos;, &apos;zfill&apos;]
</code></pre><p>The methods starting with <code>__</code> are special or magic methods which are not normally used.</p>
<p>Some examples of the methods are given below. We will use others when we start reading files.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">myString <span class="token operator">=</span> <span class="token string">&quot;The quick brown fox&quot;</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>myString<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">&quot;The&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>myString<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">&quot;The&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment"># notice that string positions start with 0 like all indexing in Python</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>myString<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token comment"># The contents of myString is not changed, if you wanted an uppercase version</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>myString<span class="token punctuation">)</span>                    <span class="token comment"># you would have to assign it to a new variable</span>
</pre><p>The methods starting with &apos;is...&apos; return a boolean value of either True or False</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>myString<span class="token punctuation">.</span>isalpha<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
</pre><p>The example above returns <code>False</code> because the space character is not considered to be an Alphanumeric value.</p>
<p>In the example below, we can use the <code>replace()</code> method to remove the spaces and then check to see if the result <code>isalpha</code>. Chaining methods in this way is quite common. The actions take place in a left to right manner. You can always avoid using chaining by using intermediary variables.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>myString<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isalpha<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><p>For example, the following is equivalent to the above</p>
<pre data-role="codeBlock" data-info="python" class="language-python">mystring_clean <span class="token operator">=</span> myString<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>mystring_clean<span class="token punctuation">.</span>isalpha<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>True
0
THE QUICK BROWN FOX
The quick brown fox
False
True
</code></pre><p>If you need to refer to a specific element (character) in a string, you can do so by specifying the index of the character in <code>[]</code> you can also use indexing to select a substring of the string. In Python, indexes begin with <code>0</code> (see <a href="http://interactivepython.org/runestone/static/CS152f17/Strings/IndexOperatorWorkingwiththeCharactersofaString.html">Index Operator: Working with the Characters of a String</a> for a visual).</p>
<pre data-role="codeBlock" data-info="python" class="language-python">myString <span class="token operator">=</span> <span class="token string">&quot;The quick brown fox&quot;</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>myString<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>myString<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>myString<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>myString<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>myString<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token comment"># from index 0 to the end</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>myString<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token comment"># from the beginning to one before index 9</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>myString<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>T
o
x
The
The quick brown fox
The quick
The quick
</code></pre><h2 class="mume-header" id="basic-python-data-types">Basic Python data types</h2>

<p>So far we have seen three basic Python data types; Integer, Float and String. There is another basic data type; Boolean. Boolean variables can only have the values of either <code>True</code> or <code>False</code>. (Remember, Python is case sensitive, so be careful of your spelling.)<br>
We can define variables to be of type boolean by setting their value accordingly. Boolean variables are a good way of coding anything that has a binary range (eg: yes/no), because it&apos;s a type that computers know how to work with as we will see soon.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">bool_val_t <span class="token operator">=</span> <span class="token boolean">True</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>bool_val_t<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>bool_val_t<span class="token punctuation">)</span>
bool_val_f <span class="token operator">=</span> <span class="token boolean">False</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>bool_val_f<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>bool_val_f<span class="token punctuation">)</span>
</pre><p>We can also get variables of this type using comparison operators, basic ones in Python are <code>==</code> for &quot;equal to&quot;, <code>!=</code> for &quot;not equal to&quot;, and <code>&gt;</code>, <code>&lt;</code>, or <code>&gt;=</code>, <code>&lt;=</code>.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;hello&apos;</span> <span class="token operator">==</span> <span class="token string">&apos;HELLO&apos;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;hello&apos;</span> <span class="token keyword">is</span> <span class="token string">&apos;hello&apos;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">!=</span> <span class="token number">77</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;four&apos;</span> <span class="token operator">&gt;</span> <span class="token string">&apos;three&apos;</span><span class="token punctuation">)</span>

</pre><pre data-role="codeBlock" data-info class="language-"><code>False
True
True
True
False
</code></pre><h2 class="mume-header" id="structured-data-types">Structured data types</h2>

<p>A structured data type is a data type which is made up of some combination of the base data types in a well defined but potentially arbitrarily complex way.</p>
<h3 class="mume-header" id="the-list">The list</h3>

<p>A list is a set of values, of any type separated by commas and delimited by &apos;[&apos; and &apos;]&apos;</p>
<pre data-role="codeBlock" data-info="python" class="language-python">list1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">89</span> <span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>list1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>list1<span class="token punctuation">)</span><span class="token punctuation">)</span>

list2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3.142</span><span class="token punctuation">,</span> <span class="token number">2.71828</span><span class="token punctuation">,</span> <span class="token number">9.8</span> <span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>list2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>list2<span class="token punctuation">)</span><span class="token punctuation">)</span>

myname <span class="token operator">=</span> <span class="token string">&quot;Peter&quot;</span>
list3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">,</span> <span class="token string">&apos;to&apos;</span><span class="token punctuation">,</span> myname <span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>list3<span class="token punctuation">)</span>
myname <span class="token operator">=</span> <span class="token string">&quot;Fred&quot;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>list3<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>list3<span class="token punctuation">)</span><span class="token punctuation">)</span>

list4 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">5.4</span><span class="token punctuation">,</span> <span class="token string">&quot;numbers&quot;</span><span class="token punctuation">,</span> <span class="token boolean">True</span> <span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>list4<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>list4<span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>[6, 54, 89]
&lt;class &apos;list&apos;&gt;
[3.142, 2.71828, 9.8]
&lt;class &apos;list&apos;&gt;
[&apos;Hello&apos;, &apos;to&apos;, &apos;Peter&apos;]
[&apos;Hello&apos;, &apos;to&apos;, &apos;Peter&apos;]
&lt;class &apos;list&apos;&gt;
[6, 5.4, &apos;numbers&apos;, True]
&lt;class &apos;list&apos;&gt;
</code></pre><h2 class="mume-header" id="exercise-1">Exercise</h2>

<p>We can index lists the same way we indexed strings before or using a boolean list of the same length.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">num_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">]</span>
</pre><p>Using the number list defined above, complete the code below and display the values of <code>odd_from_list</code> and <code>last_num_in_list</code> to check your work.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">is_odd <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token boolean">False</span><span class="token punctuation">,</span> ___<span class="token punctuation">]</span>
odd_from_list <span class="token operator">=</span>
last_num_in_list <span class="token operator">=</span>
</pre><details><summary><b>Solution</b>  - click me</summary>
<pre data-role="codeBlock" data-info="python" class="language-python">is_odd <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">]</span>
odd_from_list <span class="token operator">=</span> num_list<span class="token punctuation">[</span>is_odd<span class="token punctuation">]</span>
last_num_in_list <span class="token operator">=</span> num_list<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
</pre></details>
<br>
<h3>The range function</h3>
<p>In addition to explicitly creating lists as we have above it is very common to create and populate them automatically using the <code>range()</code> function in combination with the <code>list()</code> function</p>
<pre data-role="codeBlock" data-info="python" class="language-python">list5 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>list5<span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>[0, 1, 2, 3, 4]
</code></pre><p>Unless told not to <code>range()</code> returns a sequence which starts at 0, counts up by 1 and ends 1 <strong>before</strong> the value of the provided parameter.</p>
<p>This can be a cause of confusion. <code>range(5)</code> above does indeed have 5 values, but rather than being 1,2,3,4,5 which you might naturally think, they are in fact 0,1,2,3,4. The range starts at 0 and  stops one before the value of the single parameter we specified.</p>
<p>If you want different sequences, then you can modify the behavior of the <code>range()</code> function by using additional parameters.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">list6 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>list6<span class="token punctuation">)</span>
list7 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>list7<span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>[1, 2, 3, 4, 5, 6, 7, 8]
[2, 4, 6, 8, 10]
</code></pre><p>When you specify 3 parameters as we have for list(7); the first is start value, the second is one past the last value and the 3rd parameter is a step value by which to count. The step value can be negative</p>
<p><code>list7</code> produces the even numbers from 1 to 10.</p>
<h2>Exercise</h2>
<ol>
<li>What is produced if you change the step value in <code>list7</code> to -2 ? Is this what you expected?</li>
<li>Create a list using the <code>range()</code> function which contains the even number between 1 and 10 in reverse order ([10,8,6,4,2])</li>
</ol>
<details><summary><b>Solution</b>  - click me</summary>
<pre data-role="codeBlock" data-info="python" class="language-python">list7 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>list7<span class="token punctuation">)</span>

list8 <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>list8<span class="token punctuation">)</span>
</pre><p>list7 will print nothing because starting at 2 and incrementing by -2 is the wrong direction to 11.</p>
</details>
<br>
<p>The other main structured data type is the Dictionary. We will introduce this in a later episode when we look at JSON.</p>
<h2>Programs are rarely linear</h2>
<p>Most programs do not work by executing a simple sequential set of statements. The code is constructed so that decisions and different paths through the program can be taken based on changes in variable values.</p>
<p>To make this possible all programming language have a set of control structures which allow this to happen.</p>
<p>In this episode we are going to look at how we can create loops and branches in our Python code.<br>
Specifically we will look at three control structures, namely:</p>
<ul>
<li>If..Else..</li>
<li>While...</li>
<li>For ...</li>
</ul>
<h2>The <code>if</code> statement and variants</h2>
<p>The simple <code>if</code> statement allows the program to branch based on the evaluation of an expression</p>
<p>The basic format of the <code>if</code> statement is:</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">if</span> expression <span class="token punctuation">:</span>
    statement <span class="token number">1</span>
    statement <span class="token number">2</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    statement n

statement always executed
</pre><p>If the expression evaluates to <code>True</code> then the statements 1 to n will be executed followed by <code>statement always executed</code> . If the expression is <code>False</code>, only <code>statement always executed</code> is executed. Python knows which lines of code are related to the <code>if</code> statement by the indentation, no extra syntax is necessary.</p>
<p>Below are some examples:</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\nExample 1\n&quot;</span><span class="token punctuation">)</span>

value <span class="token operator">=</span> <span class="token number">5</span>
threshold<span class="token operator">=</span> <span class="token number">4</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;value is&quot;</span><span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token string">&quot;threshold is &quot;</span><span class="token punctuation">,</span>threshold<span class="token punctuation">)</span>
<span class="token keyword">if</span> value threshold <span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token string">&quot;is above &quot;</span><span class="token punctuation">,</span> threshold<span class="token punctuation">,</span> <span class="token string">&quot; threshold&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\nExample 2\n&quot;</span><span class="token punctuation">)</span>


high_threshold <span class="token operator">=</span> <span class="token number">6</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;value is&quot;</span><span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token string">&quot;new threshold is &quot;</span><span class="token punctuation">,</span>high_threshold<span class="token punctuation">)</span>
<span class="token keyword">if</span> value high_threshold <span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>value <span class="token punctuation">,</span> <span class="token string">&quot;is above &quot;</span><span class="token punctuation">,</span> high_threshold<span class="token punctuation">,</span> <span class="token string">&quot;threshold&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\nExample 3\n&quot;</span><span class="token punctuation">)</span>


mid_threshold <span class="token operator">=</span> <span class="token number">5</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;value is&quot;</span><span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token string">&quot;final threshold is &quot;</span><span class="token punctuation">,</span>mid_threshold<span class="token punctuation">)</span>
<span class="token keyword">if</span> value <span class="token operator">==</span> mid_threshold <span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;value, &quot;</span><span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token string">&quot; and threshold,&quot;</span><span class="token punctuation">,</span> mid_threshold<span class="token punctuation">,</span> <span class="token string">&quot;, are equal&quot;</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>Example 1

value is 5 threshold is 4
5 is bigger than  4

Example 2

value is 5 new threshold is 6

Example 3

value is 5 final threshold is 5
value, 5, and threshold, 5, are equal
</code></pre><p>In the examples above there are three things to notice:</p>
<ol>
<li>The colon <code>:</code> at the end of the <code>if</code> line. Missing this out is a common error.</li>
<li>The indentation of the print statement. If you remembered the <code>:</code> on the line before, Jupyter (or any other Python IDE) will automatically do the indentation for you. All of the statements indented at this level are considered to be part of the <code>if</code> statement. This is a feature fairly unique to Python, that it cares about the indentation. If there is too much, or too little indentation, you will get an error.</li>
<li>The <code>if</code> statement is ended by removing the indent. There is no explicit end to the <code>if</code> statement as there is in many other programming languages</li>
</ol>
<p>In the last example, notice that in Python the operator used to check equality is <code>==</code>.</p>
<h2>Exercise</h2>
<p>Add another if statement to example 2 that will check if b is greater than or equal to a</p>
<details><summary><b>Solution</b>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\nExample 2a\n&quot;</span><span class="token punctuation">)</span>

a<span class="token operator">=</span> <span class="token number">3</span>
b<span class="token operator">=</span> <span class="token number">4</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;a is&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> <span class="token string">&quot;b is&quot;</span><span class="token punctuation">,</span>b<span class="token punctuation">)</span>
<span class="token keyword">if</span> a b <span class="token punctuation">:</span>
     <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">&quot;is bigger than &quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token keyword">if</span> a <span class="token operator">&lt;=</span> b <span class="token punctuation">:</span>
     <span class="token keyword">print</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token string">&quot;is bigger than or equal to &quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span>
</pre></summary></details>
<br>
<p>Instead of using two separate <code>if</code> statements to decide which is larger we can use the <code>if ... else ...</code> construct</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment">#  If ... Else ...</span>
<span class="token operator">&lt;</span>p <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;mume-header &quot;</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token string">&quot;if-else&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>


value <span class="token operator">=</span> <span class="token number">4</span>
threshold <span class="token operator">=</span> <span class="token number">5</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;value = &quot;</span><span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token string">&quot;and threshold = &quot;</span><span class="token punctuation">,</span> threshold<span class="token punctuation">)</span>

<span class="token keyword">if</span> value threshold <span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;above threshold&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">else</span> <span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;below threshold&quot;</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>value = 4 and threshold = 5
below threshold
</code></pre><blockquote>
<h2>Exercise</h2>
<p>Repeat above with different operators &apos;&lt;&apos; , &apos;==&apos;</p>
</blockquote>
<p>A further extension of the <code>if</code> statement is the <code>if ... elif ...else</code> version.</p>
<p>The example below allows you to be more specific about the comparison of a and b.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment">#  If ... Elif ... Else ... EndIf</span>
<span class="token operator">&lt;</span>p <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;mume-header &quot;</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token string">&quot;if-elif-else-endif&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>


a <span class="token operator">=</span> <span class="token number">5</span>
b <span class="token operator">=</span> <span class="token number">4</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;a = &quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> <span class="token string">&quot;and b = &quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>

<span class="token keyword">if</span> a b <span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">&quot; is greater than &quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token keyword">elif</span> a <span class="token operator">==</span> b <span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">&quot; equals &quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token keyword">else</span> <span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token string">&quot; is less than &quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>a = 5 and b = 4
5 is greater than 4
</code></pre><p>The overall structure is similar to the <code>if ... else</code> statement. There are three additional things to notice:</p>
<ol>
<li>Each <code>elif</code> clause has its own test expression.</li>
<li>You can have as many <code>elif</code> clauses as you need</li>
<li>Execution of the whole statement stops after an <code>elif</code> expression is found to be True. Therefore the ordering of the <code>elif</code> clause can be significant.</li>
</ol>
<h2>The <code>while</code> loop</h2>
<p>The while loop is used to repeatedly execute lines of code until some condition becomes False.</p>
<p>For the loop to terminate, there has to be something in the code which will potentially change the condition.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment">#  while loop</span>
<span class="token operator">&lt;</span>p <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;mume-header &quot;</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token string">&quot;while-loop&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>

n <span class="token operator">=</span> <span class="token number">10</span>
cur_sum <span class="token operator">=</span> <span class="token number">0</span>
<span class="token comment">#  sum of n  numbers</span>
<span class="token operator">&lt;</span>p <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;mume-header &quot;</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token string">&quot;sum-of-n-numbers&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>

i <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">while</span>  i <span class="token operator">&lt;=</span> n <span class="token punctuation">:</span>
    cur_sum <span class="token operator">=</span> cur_sum <span class="token operator">+</span> i
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;The sum of the numbers from 1 to&quot;</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> <span class="token string">&quot;is &quot;</span><span class="token punctuation">,</span> cur_sum<span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>The sum of the numbers from 1 to 10 is 55
</code></pre><p>Points to note:</p>
<ol>
<li>The condition clause (i &lt;= n) in the while statement can be anything which when evaluated would return a Boolean value of either True of False. Initially i has been set to 1 (before the start of the loop) and therefore the condition is <code>True</code>.</li>
<li>The clause can be made more complex by use of parentheses and <code>and</code> and <code>or</code>  operators amongst others</li>
<li>The statements after the while clause are only executed if the condition evaluates as True.</li>
<li>Within the statements after the while clause there should be something which potentially will make the condition evaluate as <code>False</code> next time around. If not the loop will never end.</li>
<li>In this case the last statement in the loop changes the value of i which is part of the condition clause, so hopefully the loop will end.</li>
<li>We called our variable <code>cur_sum</code> and not <code>sum</code> because <code>sum</code> is a builtin function (try typing it in, notice the editor changes it to green).  If we define <code>sum = 0</code> now we can&apos;t use the function <code>sum</code> in this Python session.</li>
</ol>
<h2>Exercise - Things that can go wrong with while loops</h2>
<p>In the examples below, without running them try to decide why we will not get the required answer.<br>
Run each, one at a time, and then correct them. Remember that when the input next to a notebook cell is [*] your Python interpreter is still working.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment">#  while loop - summing the numbers 1 to 10</span>
<span class="token operator">&lt;</span>p <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;mume-header &quot;</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token string">&quot;while-loop-summing-the-numbers-1-to-10&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>

n <span class="token operator">=</span> <span class="token number">10</span>
cur_sum <span class="token operator">=</span> <span class="token number">0</span>
<span class="token comment">#  sum of n  numbers</span>
<span class="token operator">&lt;</span>p <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;mume-header &quot;</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token string">&quot;sum-of-n-numbers-1&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>

i <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span>  i <span class="token operator">&lt;=</span> n <span class="token punctuation">:</span>
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
     cur_sum <span class="token operator">=</span> cur_sum <span class="token operator">+</span> i
     
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;The sum of the numbers from 1 to&quot;</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> <span class="token string">&quot;is &quot;</span><span class="token punctuation">,</span> cur_sum<span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># while loop - summing the numbers 1 to 10</span>
n <span class="token operator">=</span> <span class="token number">10</span>
cur_sum <span class="token operator">=</span> <span class="token number">0</span>
boolvalue <span class="token operator">=</span> <span class="token boolean">False</span>
<span class="token comment"># sum of n  numbers</span>
i <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span>  i <span class="token operator">&lt;=</span> n <span class="token keyword">and</span> boolvalue<span class="token punctuation">:</span>
    cur_sum <span class="token operator">=</span> cur_sum <span class="token operator">+</span> i
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
    
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;The sum of the numbers from 1 to&quot;</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> <span class="token string">&quot;is &quot;</span><span class="token punctuation">,</span> cur_sum<span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># while loop - summing the numbers 1 to 10</span>
n <span class="token operator">=</span> <span class="token number">10</span>
cur_sum <span class="token operator">=</span> <span class="token number">0</span>
<span class="token comment"># sum of n  numbers</span>
i <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span>  i <span class="token operator">!=</span> n <span class="token punctuation">:</span>
    cur_sum <span class="token operator">=</span> cur_sum <span class="token operator">+</span> i
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;The sum of the numbers from 1 to&quot;</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> <span class="token string">&quot;is &quot;</span><span class="token punctuation">,</span> cur_sum<span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># while loop - summing the numbers 1.1 to 9.9 i. steps of 1.1</span>
n <span class="token operator">=</span> <span class="token number">9.9</span>
cur_sum <span class="token operator">=</span> <span class="token number">0</span>
<span class="token comment"># sum of n  numbers</span>
i <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">while</span>  i <span class="token operator">!=</span> n <span class="token punctuation">:</span>
    cur_sum <span class="token operator">=</span> cur_sum <span class="token operator">+</span> i
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1.1</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;The sum of the numbers from 1.1 to&quot;</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> <span class="token string">&quot;is &quot;</span><span class="token punctuation">,</span> <span class="token builtin">sum</span><span class="token punctuation">)</span>
</pre><details><summary><b>Solution</b>  - click me</summary>
<ol>
<li>Because i is incremented before the sum, you are summing 1 to 11.</li>
<li>The Boolean value is set to False the loop will never be executed.</li>
<li>When i does equal 10 the expression is False and the loop does not execute so we have only summed 1 to 9</li>
<li>Because you cannot guarantee the internal representation of Float, you should never try to compare them for equality. In this particular case the i never &apos;equals&apos; n and so the loop never ends. - If you did try running this, you can stop it using <kbd>Ctrl</kbd>+<kbd>c&lt;/kbdin a terminal or going to the kernel menu of a notebook and choosing interrupt.</kbd></li>
</ol>
</details>
<br>
<h2 class="mume-header" id="the-for-loop">The <code>for</code> loop</h2>

<p>The for loop, like the while loop repeatedly executes a set of statements. The difference is that in the for loop we know in at the outset how often the statements in the loop will be executed. We don&apos;t have to rely on a variable being changed within the looping statements.</p>
<p>The basic format of the <code>for</code> statement is</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">for</span> variable_name <span class="token keyword">in</span> some_sequence <span class="token punctuation">:</span>
    statement1
    statement2
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    statementn
</pre><p>The key part of this is the <code>some_sequence</code>. The phrase used in the documentation is that it must be &apos;iterable&apos;. That means, you can count through the sequence, starting at the beginning and stopping at the end.</p>
<p>There are many examples of things which are iterable some of which we have already come across.</p>
<ul>
<li>Lists are iterable - they don&apos;t have to contain numbers, you iterate over the elements in the list.</li>
<li>The <code>range()</code> function</li>
<li>The characters in a string</li>
</ul>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\nExample 1\n&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\nExample 2\n&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> name <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">&quot;Tom&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Dick&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Harry&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\nExample 3\n&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> name <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">&quot;Tom&quot;</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">3.142</span><span class="token punctuation">]</span> <span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\nExample 4\n&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\nExample 5\n&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\nExample 6\n&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\nExample 7\n&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token string">&quot;ABCDE&quot;</span> <span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;\nExample 8\n&quot;</span><span class="token punctuation">)</span>
longString <span class="token operator">=</span> <span class="token string">&quot;The quick brown fox jumped over the lazy sleeping dog&quot;</span>
<span class="token keyword">for</span> word <span class="token keyword">in</span> longString<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span>

</pre><pre data-role="codeBlock" data-info class="language-"><code>Example 1

1
2
3

Example 2

Tom
Dick
Harry

Example 3

Tom
42
3.142

Example 4

0
1
2

Example 5

1
2
3

Example 6

2
4
6
8
10

Example 7

A
B
C
D
E

Example 8

The
quick
brown
fox
jumped
over
the
lazy
sleeping
dog
</code></pre><h2 class="mume-header" id="exercise-2">Exercise</h2>

<p>Suppose that we have a string containing a set of 4 different values separated by <code>;</code>  like this:</p>
<pre data-role="codeBlock" data-info="python" class="language-python">items_owned <span class="token operator">=</span> <span class="token string">&quot;bicycle;television;solar_panel;table&quot;</span>
</pre><p>Research the <code>split()</code> method and then rewrite example 8 so that it prints the 4 components of <code>items_owned</code></p>
<details><summary><b>Solution</b> - click me</summary>
<br>
<pre data-role="codeBlock" data-info="python" class="language-python">variablelist <span class="token operator">=</span> <span class="token string">&quot;01/01/2010,34.5,Yellow,True&quot;</span>
<span class="token keyword">for</span> word <span class="token keyword">in</span> variablelist<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span>
</pre><p>The format of <code>variablelist</code> is very much like that of a record in a csv file. In later episodes we will see how we can extract these values and assign them to variables for further processing rather than printing them out.</p>
</details>
<br>
<h2 class="mume-header" id="defining-a-function">Defining a function</h2>

<p>We have already made use of several Python builtin functions like <code>print</code>, <code>list</code> and <code>range</code>.</p>
<p>In addition to the functions provided by Python, you can write your own functions.</p>
<p>Functions are used when a section of code needs to be repeated at various different points in a program. It saves you re-writing it all. In reality you rarely need to repeat the exact same code. Usually there will be some variation in variable values needed. Because of this, when you create a function you are allowed to specify a set of <code>parameters</code> which represent variables in the function.</p>
<p>In our use of the <code>print</code> function we have provided as a parameter, whatever it is we wanted to <code>print</code>. Typically whenever we use the print function we pass a different parameter value.</p>
<p>The ability to specify parameters make functions very flexible.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">def</span> <span class="token function">get_item_count</span><span class="token punctuation">(</span>item_str<span class="token punctuation">,</span>sep<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&apos;&apos;&apos;
    This function takes a string with a list of items and the character that they&apos;re separated by and returns the number of items
    &apos;&apos;&apos;</span>
    items_list <span class="token operator">=</span> items_str<span class="token punctuation">.</span>split<span class="token punctuation">(</span>sep<span class="token punctuation">)</span>
    num_items <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>items_list<span class="token punctuation">)</span>
    <span class="token keyword">return</span> num_items

items_owned <span class="token operator">=</span> <span class="token string">&quot;bicycle;television;solar_panel;table&quot;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>get_item_count<span class="token punctuation">(</span>items_owned<span class="token punctuation">,</span><span class="token string">&apos;;&apos;</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>4
</code></pre><p>Points to note:</p>
<ol>
<li>The definition of a function (or procedure) starts with the def keyword and is followed by the name of the function with any parameters used by the function in brackets.</li>
<li>The definition clause is terminated with a <code>:</code> which causes indentation on the next and subsequent lines. All of these lines form the statements which make up the function. The function ends after the indentation is removed.</li>
<li>Within the function, the parameters behave as variables whose initial values will be those that they were given when the function was called.</li>
<li>functions have a return statement which specifies the value to be returned. This is the value assigned to the variable on the left-hand side of the call to the function. (power in the example above)</li>
<li>You call (run the code) of a function simply by providing its name and values for its parameters the same way you would for any builtin function.</li>
<li>Once the definition of the function has been executed, it becomes part of Python for the current session and can be used anywhere.</li>
<li>Like any other builtin function you can use <code>shift</code> + <code>tab</code> in Jupyter to see the parameters.</li>
<li>At the beginning of the function code we have a multiline  <code>comment</code> denoted by the <code>&apos;&apos;&apos;</code> at the beginning and end. This kind of comment is known as a <code>docstring</code> and can be used anywhere in Python code as a documentation aid. It is particularly common, and indeed best practice, to use them to give a brief description of the function at the beginning of a function definition in this way. This is because this description will be displayed along with the parameters when you use the help() function or <code>shift</code> + <code>tab</code> in Jupyter.</li>
<li>The variable <code>x</code> defined within the function only exists within the function, it cannot be used outside in the main program.</li>
</ol>
<p>In our <code>get_item_count</code> function we have two parameters which must be provided every time the function is used. You need to  provide the parameters in the right order or to explicitly name the parameter you are referring to and use the <code>=</code> sign to give it a value.</p>
<p>In many cases of functions we want to provide default values for parameters so the user doesn&apos;t have to. We can do this in the following way</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">def</span> <span class="token function">get_item_count</span><span class="token punctuation">(</span>item_str<span class="token punctuation">,</span>sep<span class="token operator">=</span><span class="token string">&apos;;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&apos;&apos;&apos;
    This function takes a string with a list of items and the character that they&apos;re separated by and returns the number of items
    &apos;&apos;&apos;</span>
    items_list <span class="token operator">=</span> items_str<span class="token punctuation">.</span>split<span class="token punctuation">(</span>sep<span class="token punctuation">)</span>
    num_items <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>items_list<span class="token punctuation">)</span>
    <span class="token keyword">return</span> num_items


<span class="token keyword">print</span><span class="token punctuation">(</span>get_item_count<span class="token punctuation">(</span>items_owned<span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>9
</code></pre><p>The only change we have made is to provide a default value for the <code>sep</code> parameter. Now if the user does not provide a value, then the value of 2 will be used. Because <code>items_str</code> is the first parameter we can specify its value by position. We could however have explicitly named the parameters we were referring to.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>get_item_count<span class="token punctuation">(</span>sep <span class="token operator">=</span> <span class="token string">&apos;,&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>get_item_count<span class="token punctuation">(</span>items_str <span class="token operator">=</span> items_owned<span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">&apos;;&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>1
4
</code></pre><h2 class="mume-header" id="exercise-3">Exercise</h2>

<ol>
<li>
<p>Write a function definition to calculate the volume of a cuboid. The function will use three parameters <code>H</code>, <code>W</code> and <code>L</code> and return the volume.</p>
</li>
<li>
<p>Supposing that in addition to the volume I also wanted to calculate the surface area and the sum of all of the edges. Would I (or should I) have three separate functions or could I write a single function to provide all three values together?</p>
</li>
</ol>
<details><summary><b>Solution</b>  - click me</summary>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">def</span> <span class="token function">cuboid</span><span class="token punctuation">(</span>H<span class="token punctuation">,</span>W<span class="token punctuation">,</span>L<span class="token punctuation">)</span><span class="token punctuation">:</span>
    vol <span class="token operator">=</span> H<span class="token operator">*</span>W<span class="token operator">*</span>L
    sa <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span>H<span class="token operator">*</span>W <span class="token operator">+</span> H<span class="token operator">*</span>L <span class="token operator">+</span> L<span class="token operator">*</span>W<span class="token punctuation">)</span>
    edges <span class="token operator">=</span> <span class="token number">4</span><span class="token operator">*</span><span class="token punctuation">(</span>H <span class="token operator">+</span> W <span class="token operator">+</span> L<span class="token punctuation">)</span>
    <span class="token keyword">return</span> vol<span class="token punctuation">,</span> sa<span class="token punctuation">,</span> edges

volume<span class="token punctuation">,</span> surface_area<span class="token punctuation">,</span> length_of_edges <span class="token operator">=</span> cuboid<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Volume = &quot;</span><span class="token punctuation">,</span> volume<span class="token punctuation">,</span> <span class="token string">&quot; Surface_area = &quot;</span><span class="token punctuation">,</span> surface_area<span class="token punctuation">,</span> <span class="token string">&quot; Sum of edges = &quot;</span><span class="token punctuation">,</span> length_of_edges<span class="token punctuation">)</span>
</pre><p>The cuboid function above returns all three values from a single call. This means that you need three variables in which to place the 3 returned values. If you do not provide three variables, you will get an error.<br>
Unless you are always going to use the 3 values, it would probably be better in this case to use distinct functions for these three cases.</p>
</details>
<br>
<h2 class="mume-header" id="using-libraries">Using libraries</h2>

<p>The functions we have created above only exist for the duration of the session in which they have been defined. If you start a new Jupyter notebook you will have to run the code to define them again.</p>
<p>If all of your code is in a single file or notebook this isn&apos;t really a problem.</p>
<p>There are however many (thousands) of useful functions which other people have written and have made available to all Python users by creating libraries (also referred to as packages or modules) of functions.</p>
<p>You can find out what all of these libraries are and their contents by visiting the main (<a href="http://python.org">python.org</a>) site.</p>
<p>We need to go through a 2-step process before we can use them in our own programs.</p>
<p><strong>Step 1.</strong>  use the <code>pip</code> command from the commandline. <code>pip</code> is installed as part of the Python install and is used to fetch the package from the Internet and install it in your Python configuration.</p>
<pre data-role="codeBlock" data-info="bash" class="language-bash">pip <span class="token function">install</span> <span class="token operator">&lt;</span>package name<span class="token operator">&gt;</span>
</pre><p>pip stands for Python install package and is a commandline function. Because we are using the Anaconda distribution of Python, all of the packages that we will be using in this lesson are already installed for us, so we can move straight on to step 2.</p>
<p><strong>Step 2.</strong> In your Python code include an <code>import package-name</code> statement. Once this is done, you can use all of the functions contained within the package.</p>
<p>As all of these packages are produced by 3rd parties independently of each other, there is the strong possibility that there may be clashes in function names. To allow for this, when you are calling a function from a package that you have imported, you do so by prefixing the function name with the package name. This can make for long-winded function names so the <code>import</code> statement allows you to specify an <code>alias</code> for the package name which you must then use instead of the package name.</p>
<p>In future episodes, we will be importing the <code>csv</code>, <code>json</code>, <code>pandas</code>, <code>numpy</code> and <code>matplotlib</code> modules. We will describe their use as we use them.</p>
<p>The code that we will use is shown below</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">import</span> csv
<span class="token keyword">import</span> json
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
</pre><p>The first two we don&apos;t alias as they have short names. The last three we do. Matplotlib is a very large library broken up into what can be thought of as sub-libraries. As we will only be using the functions contained in the <code>pyplot</code> sub-library we can specify that explicitly when we import. This saves time and space. It does not effect how we call the functions in our code.</p>
<p>The <code>alias</code> we use (specified after the <code>as</code> keyword) is entirely up to us. However those shown here for <code>pandas</code>, <code>numpy</code> and <code>matplotlib</code> are nearly universally adopted conventions used for these popular libraries. If you are searching for code examples for these libraries on the Internet, using these aliases will appear most of the time.</p>
<h2 class="mume-header" id="reading-and-writing-datasets">Reading and Writing datasets</h2>

<p>In all of our examples so far, we have directly allocated values to variables in the code we have written before using the variables.</p>
<p>Python has an <code>input()</code> function which will ask for input from the user, but for any large amounts of data this will be an  impractical way of collecting data.</p>
<p>The reality is that most of the data that your program uses will be read from a file. Additionally, apart from when you are developing, most of your program output will be written to a file.</p>
<p>In this episode we will look at how to read and write files of data in Python.</p>
<p>There are in fact many different approaches to reading data files and which one you choose will depend on such things as the size of the file and the data format of the file.</p>
<p>In this episode we will;</p>
<ul>
<li>We will read a file which is in .csv (Comma Separated Values) format.</li>
<li>We will use standard core Python functions to do this</li>
<li>We will read the file one line at a time ( line = record = row of a table)</li>
<li>We will perform simple processing of the file data and print the output</li>
<li>We will split the file into smaller files based on some processing</li>
</ul>
<p>The file we will be using is only a small file (350 data records), but the approach we are using will work for any size of file. Imagine 35M records. This is because we only process one record at a time so the memory requirements of the programs will be very small. The larger the file the more the processing time required.</p>
<p>Other approaches to reading files will typically expect to read the whole file in one go. This can be efficient when you subsequently process the data but it require large amounts of memory to hold the entire file. We will look at this approach later when the look at the Pandas package.</p>
<p>For our examples in this episode we are going to use the SAFI_farms.csv file. This is available for download <a href="./data/SAFI_farms.csv">here</a> and the description of the file is available <a href="./data/SAFI_desc.txt">here</a></p>
<p>The code assumes that the file is in a <code>/data/</code> directory within the same directory as your notebook. If you have saved your datafiles elsewhere, you may need to adjust the code accordingly.</p>
<p>We will build up our programs in simple steps</p>
<h3 class="mume-header" id="step-1-open-the-file-read-through-it-and-close-the-file">Step 1 - Open the file , read through it and close the file</h3>

<pre data-role="codeBlock" data-info="python" class="language-python">filename <span class="token operator">=</span> <span class="token string">&quot;data/SAFI_farms.csv&quot;</span>
f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">&quot;r&quot;</span><span class="token punctuation">)</span>    <span class="token comment"># open the file whose name is in filename, the &apos;r&apos; means we want to read from the file</span>
                           <span class="token comment"># the open function returns what is called a file handle. we use this to refer to the file</span>
<span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>             <span class="token comment"># We use a for loop to iterate through the file one line at a time.</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>            <span class="token comment"># we simply print the line</span>

f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>                  <span class="token comment"># Always close the file at the end.</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>Column1,A01_interview_date,A03_quest_no,A04_start,A05_end,A06_province,A07_district,A08_ward,A09_village,A11_years_farm,A12_agr_assoc,B11_remittance_money,B16_years_liv,B17_parents_liv,B18_sp_parents_liv,B19_grand_liv,B20_sp_grand_liv,B_no_membrs,C01_respondent_roof_type,C02_respondent_wall_type,C02_respondent_wall_type_other,C03_respondent_floor_type,C04_window_type,C05_buildings_in_compound,C06_rooms,C07_other_buildings,D_plots_count,E01_water_use,E17_no_enough_water,E19_period_use,E20_exper_other,E21_other_meth,E23_memb_assoc,E24_resp_assoc,E25_fees_water,E26_affect_conflicts,E_no_group_count,E_yes_group_count,F04_need_money,F05_money_source_other,F06_crops_contr,F08_emply_lab,F09_du_labour,F10_liv_owned_other,F12_poultry,F13_du_look_aftr_cows,F_liv_count,G01_no_meals,_members_count,_note,gps:Accuracy,gps:Altitude,gps:Latitude,gps:Longitude,instanceID

0,17/11/2016,1,2017-03-23T09:49:57.000Z,2017-04-02T17:29:08.000Z,Province1,District1,Ward2,Village2,11,no,no,4,no,yes,no,yes,3,grass,muddaub,,earth,no,1,1,no,2,no,,,,,,,,,2,,,,,no,no,,yes,no,1,2,3,,14,698,-19.11225943,33.48345609,uuid:ec241f2c-0609-46ed-b5e8-fe575f6cefef
...
</code></pre><p>You can think of the file as being a list of strings. Each string in the list is one complete line from the file.</p>
<p>If you look at the output, you can see that the first record in the file is a header record containing column names. When we read a file in this way, the column headings have no significance, the computer sees them as another record in the file.</p>
<h3 class="mume-header" id="step-2-select-a-specific-column-from-the-records-in-the-file">Step 2 - Select a specific &apos;column&apos; from the records in the file</h3>

<p>We know that the first record in the file is a header record and we want to ignore it. To do this we call the <code>readline()</code> method of the file handle <code>f</code>. We don&apos;t need to assign the line that it will return to a variable as we are not going to use it.</p>
<p>As we read the file the line variable is a string containing a complete record. The fields or columns of the record are separated by each other by &quot;,&quot; as it is a csv file.</p>
<p>As line is a string we can use the <code>split()</code> method to convert it to a <code>list</code> of column values. We are specicically going to select the column which is the 21st entry in the list (remember the list index starts at 0). This refers to the C01_respondent_roof_type column. We are going to examine the different roof types.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">filename <span class="token operator">=</span> <span class="token string">&quot;data/SAFI_farms.csv&quot;</span>
f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">&quot;r&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># first line is a header so ignore it</span>
f<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment"># index 20, the 21st column is C01_respondent_roof_type</span>

f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>grass
grass
mabatisloping
mabatisloping
grass
grass
grass
mabatisloping
...
</code></pre><p>Having a list of the roof types from all of the records is one thing, but it is more likely that we would want a count of each type. By scanning up and down the previous output, there appears to be 3 different type, but we will play safe and assume there may be more.</p>
<h3 class="mume-header" id="step-3-how-many-of-each-different-roof-types-are-there">Step 3 - How many of each different roof types are there?</h3>

<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># 1</span>
filename <span class="token operator">=</span> <span class="token string">&quot;data/SAFI_farms.csv&quot;</span>
f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">&quot;r&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># 2</span>
f<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 3</span>
grass_roof <span class="token operator">=</span> <span class="token number">0</span>
mabatisloping_roof <span class="token operator">=</span> <span class="token number">0</span>
mabatipitched_roof <span class="token operator">=</span> <span class="token number">0</span>
roof_type_other <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>
<span class="token comment"># 4</span>
    roof_type <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span>
<span class="token comment"># 5    </span>
    <span class="token keyword">if</span> roof_type <span class="token operator">==</span> <span class="token string">&apos;grass&apos;</span> <span class="token punctuation">:</span>
        grass_roof <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">elif</span> roof_type <span class="token operator">==</span> <span class="token string">&apos;mabatisloping&apos;</span> <span class="token punctuation">:</span>
        mabatisloping_roof <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">elif</span> roof_type <span class="token operator">==</span> <span class="token string">&apos;mabatipitched&apos;</span> <span class="token punctuation">:</span>
        mabatipitched_roof <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">else</span> <span class="token punctuation">:</span>
        roof_type_other <span class="token operator">+=</span> <span class="token number">1</span>
<span class="token comment">#6</span>
f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">#7</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;There are &quot;</span><span class="token punctuation">,</span> grass_roof<span class="token punctuation">,</span> <span class="token string">&quot; grass roofs&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;There are &quot;</span><span class="token punctuation">,</span> mabatisloping_roof<span class="token punctuation">,</span> <span class="token string">&quot; mabatisloping roofs&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;There are &quot;</span><span class="token punctuation">,</span> mabatipitched_roof<span class="token punctuation">,</span> <span class="token string">&quot; mabatipitched roofs&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;There are &quot;</span><span class="token punctuation">,</span> roof_type_other<span class="token punctuation">,</span> <span class="token string">&quot; other roof types&quot;</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>There are 73 grass roofs
There are 48 mabatisloping roofs
There are 10 mabatipitchedg roofs
There are 0 other roof types
</code></pre><p>What are we  doing here?</p>
<ol>
<li>Open the file</li>
<li>Ignore the headerline</li>
<li>Initialise roof type variables to 0</li>
<li>Extract the C01_respondent_roof_type information from each record</li>
<li>Increment the appropriate variable</li>
<li>close the file</li>
<li>Print out the results</li>
</ol>
<p>Instead of printing out the counts of the roof types, you may want to extract all of one particular roof type to a separate file. Let us assume we want all of the grass roof records to be written to a file.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># 1</span>
filename <span class="token operator">=</span> <span class="token string">&quot;data/SAFI_farms.csv&quot;</span>
fr <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">&quot;r&quot;</span><span class="token punctuation">)</span>

filename <span class="token operator">=</span> <span class="token string">&quot;data/SAFI_grass_roof.csv&quot;</span>
fw <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span>

<span class="token comment">#2</span>
fw<span class="token punctuation">.</span>write<span class="token punctuation">(</span>fr<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> line <span class="token keyword">in</span> fr<span class="token punctuation">:</span>
<span class="token comment"># 3    </span>
    <span class="token keyword">if</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&apos;grass&apos;</span> <span class="token punctuation">:</span>
        fw<span class="token punctuation">.</span>write<span class="token punctuation">(</span>line<span class="token punctuation">)</span>

<span class="token comment">#4</span>
fr<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
fw<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><p>What are we  doing here?</p>
<ol>
<li>Open the files. Because there are now two files, each has its own file handle: <code>fr</code> for the file we read and <code>fw</code> for the file we are going to write. (They are just variable names so you can use anything you like). For the file we are going to write to we use <code>w</code> for the second parameter. If the file does not exist it will be created. If it does exist, then the contents will be overwritten. If we want to append to an existing file we can use <code>a</code> as the second parameter.</li>
<li>Read the first line, which are the column headers and write it directly to the output file.</li>
<li>Because we are just testing a specific field from the record to have a certain value, we don&apos;t need to put it into a variable first. If the expression is True, then we use <code>write()</code> method to write the complete line just as we read it to the output file.</li>
<li>Close the files</li>
</ol>
<h2>Exercise</h2>
<p>From the SAFI_results.csv file extract all of the records where the <code>C01_respondent_roof_type</code> (index 18) has a value of <code>&apos;grass&apos;</code> and the <code>C02_respondent_wall_type</code> (index 19) has a value of <code>&apos;muddaub&apos;</code> and write them to a file. Within the same program write all of the records where <code>C01_respondent_roof_type</code> (index 18) has a value of <code>&apos;grass&apos;</code> and the <code>C02_respondent_wall_type</code> (index 19) has a value of <code>&apos;burntbricks&apos;</code> and write them to a separate file. In both files include the header record.</p>
<details><summary><b>Solution</b>  - click me</summary>
<pre data-role="codeBlock" data-info="python" class="language-python">filename <span class="token operator">=</span> <span class="token string">&quot;data/SAFI_farms.csv&quot;</span>
fr <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">&quot;r&quot;</span><span class="token punctuation">)</span>

filename <span class="token operator">=</span> <span class="token string">&quot;data/SAFI_grass_roof_muddaub.csv&quot;</span>
fw1 <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span>
filename <span class="token operator">=</span> <span class="token string">&quot;data/SAFI_grass_roof_burntbricks.csv&quot;</span>
fw2 <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">&quot;w&quot;</span><span class="token punctuation">)</span>

headerline <span class="token operator">=</span> fr<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span>
fw1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>headerline<span class="token punctuation">)</span>
fw2<span class="token punctuation">.</span>write<span class="token punctuation">(</span>headerline<span class="token punctuation">)</span>

<span class="token keyword">for</span> line <span class="token keyword">in</span> fr<span class="token punctuation">:</span>
    <span class="token keyword">if</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&apos;grass&apos;</span> <span class="token punctuation">:</span>
        <span class="token keyword">if</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&apos;muddaub&apos;</span> <span class="token punctuation">:</span>
            fw1<span class="token punctuation">.</span>write<span class="token punctuation">(</span>line<span class="token punctuation">)</span>
        <span class="token keyword">if</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&apos;burntbricks&apos;</span> <span class="token punctuation">:</span>
            fw2<span class="token punctuation">.</span>write<span class="token punctuation">(</span>line<span class="token punctuation">)</span>    

fr<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
fw1<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
fw2<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre></details>
<br>
<p>In our example of printing the counts for the roof types, we assumed that we knew what the likely roof types were. Although we did have an <code>&apos;other&apos;</code> option to catch anything we missed. Had there been any we would still be non the wiser as to what they  represented. We were able to decide on the specific roof types by manually scanning the list of <code>C01_respondent_roof_type</code> values. This was only practical because of the small file size. For a multi-million record file we could not have done this.</p>
<p>We would like a way of creating a list of the different roof types and at the same time counting them. We can do this by using not a Python <code>list</code> structure, but a Python <code>dictionary</code> .</p>
<h2 class="mume-header" id="the-python-dictionary-structure">The Python dictionary structure</h2>

<p>In Python a dictionary object maps keys to values. A dictionary can hold any number of keys and values but a key cannot be duplicated.</p>
<p>The following code shows examples of creating a dictionary object and manipulating keys and values.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># an empty dictionary</span>
myDict <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment"># A dictionary with a single Key-value pair</span>

personDict <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&apos;Name&apos;</span> <span class="token punctuation">:</span> <span class="token string">&apos;Peter&apos;</span><span class="token punctuation">}</span>

<span class="token comment"># I can add more about &apos;Peter&apos; to the dictionary</span>

personDict<span class="token punctuation">[</span><span class="token string">&apos;Location&apos;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&apos;Manchester&apos;</span>


<span class="token comment"># I can print all of the keys and values from the dictionary</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>personDict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># I can print all of the keys and values from the dictionary - and make it look a bit nicer</span>

<span class="token keyword">for</span> item <span class="token keyword">in</span> personDict<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> <span class="token string">&quot;=&quot;</span><span class="token punctuation">,</span> personDict<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># or all of the keys</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>personDict<span class="token punctuation">.</span>keys<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># or all of the values</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>personDict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># I can access the value for a given key</span>

x <span class="token operator">=</span> personDict<span class="token punctuation">[</span><span class="token string">&apos;Name&apos;</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>

<span class="token comment"># I can change value for a given key</span>

personDict<span class="token punctuation">[</span><span class="token string">&apos;Name&apos;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Fred&quot;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>personDict<span class="token punctuation">[</span><span class="token string">&apos;Name&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># I can check if a key exists</span>

key <span class="token operator">=</span> <span class="token string">&apos;Name&apos;</span>

<span class="token keyword">if</span> key <span class="token keyword">in</span> personDict <span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;already exists&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">else</span> <span class="token punctuation">:</span>
    personDict<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;New value&quot;</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>dict_items([(&apos;Location&apos;, &apos;Manchester&apos;), (&apos;Name&apos;, &apos;Peter&apos;)])
Location = Manchester
Name = Peter
dict_keys([&apos;Location&apos;, &apos;Name&apos;])
dict_values([&apos;Manchester&apos;, &apos;Peter&apos;])
Peter
Fred
already exists
</code></pre><h2>Exercise</h2>
<ol>
<li>Create a dictionary called <code>dict_roof_types</code> with initial keys of <code>type1</code> and <code>type2</code> and give them values of 1 and 3.</li>
<li>Add a third key <code>type3</code> with a value of 6.</li>
<li>Add code to check if a key of <code>type4</code> exists. If it does not add it to the dictionary with a value of 1 if it does, increment its value by 1</li>
<li>Add code to check if a key of <code>type2</code> exists. If it does not add it to the dictionary with a value of 1 if it does, increment its value by 1</li>
<li>Print out all of the keys and values from the dictionary</li>
</ol>
<details><summary><b>Solution</b>  - click me</summary>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># 1</span>
dict_roof_types <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&apos;type1&apos;</span> <span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">,</span> <span class="token string">&apos;type2&apos;</span> <span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">}</span>

<span class="token comment"># 2</span>
dict_roof_types<span class="token punctuation">[</span><span class="token string">&apos;type3&apos;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">6</span>

<span class="token comment"># 3</span>
key <span class="token operator">=</span> <span class="token string">&apos;type4&apos;</span>
<span class="token keyword">if</span> key <span class="token keyword">in</span> dict_roof_types <span class="token punctuation">:</span>
    dict_roof_types<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
<span class="token keyword">else</span> <span class="token punctuation">:</span>
    dict_roof_types<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>

<span class="token comment"># 4</span>
key <span class="token operator">=</span> <span class="token string">&apos;type2&apos;</span>
<span class="token keyword">if</span> key <span class="token keyword">in</span> dict_roof_types <span class="token punctuation">:</span>
    dict_roof_types<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
<span class="token keyword">else</span> <span class="token punctuation">:</span>
    dict_roof_types<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
 
<span class="token comment"># 5</span>
<span class="token keyword">for</span> item <span class="token keyword">in</span> dict_roof_types<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> <span class="token string">&quot;=&quot;</span><span class="token punctuation">,</span> dict_roof_types<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">)</span>
    
</pre></details>
<br>
<p>We are now in a position to re-write our count of roof types example without knowing in advance what any of the roof types are.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># 1</span>
filename <span class="token operator">=</span> <span class="token string">&quot;data/SAFI_farms.csv&quot;</span>
f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">&quot;r&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># 2</span>
f<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 3</span>
dict_roof_types <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>
<span class="token comment"># 4</span>
    roof_type <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span>
<span class="token comment"># 5    </span>
    <span class="token keyword">if</span> roof_type <span class="token keyword">in</span> dict_roof_types <span class="token punctuation">:</span>
        dict_roof_types<span class="token punctuation">[</span>roof_type<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">else</span> <span class="token punctuation">:</span>
        dict_roof_types<span class="token punctuation">[</span>roof_type<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token comment"># 6</span>
f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># 7</span>

<span class="token keyword">for</span> item <span class="token keyword">in</span> dict_roof_types<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> <span class="token string">&quot;=&quot;</span><span class="token punctuation">,</span> dict_roof_types<span class="token punctuation">[</span>item<span class="token punctuation">]</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>grass = 212
mabatisloping = 126
mabatipitched = 12
</code></pre><p>What are we  doing here?</p>
<ol>
<li>Open the file</li>
<li>Ignore the headerline</li>
<li>Create an empty dictionary</li>
<li>Extract the C01_respondent_roof_type information from each record</li>
<li>Either add to the dictionary with a value of 1 or increment the current value for the key by 1</li>
<li>close the file</li>
<li>Print out the contents of the dictionary</li>
</ol>
<p>You can apply the same approach to count values in any of the fields/columns of the file.</p>
<h2 class="mume-header" id="date-and-times-in-python">Date and Times in Python</h2>

<p>To use the date and time functions in Python you need to import the <code>datetime</code> module.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime
</pre><p>Python can be very flexible in how it interprets &apos;strings&apos; which you want to be considered as a date, time, or date and time, but you have to tell Python how the various parts of the date and/or time are represented in your &apos;string&apos;.</p>
<p>You can do this by creating a <code>format</code>. In a <code>format</code>, different case sensitive characters preceded by the <code>%</code> character act as placeholders for parts of the date/time, for example <code>%Y</code> represents year formatted as 4 digit number such as 2014.</p>
<p>A full list of the characters used and what they represent can be found towards the end of the <a href="https://docs.python.org/3/library/datetime.html">datetime</a> section of the official Python documentation.</p>
<p>There is a <code>today()</code> method which allows you to get the current date and time.<br>
By default it is displayed in a format similar to the <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a> standard format.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime

today <span class="token operator">=</span> datetime<span class="token punctuation">.</span>today<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;ISO     :&apos;</span><span class="token punctuation">,</span> today<span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>ISO     : 2018-04-12 16:19:17.177441
</code></pre><p>We can use our own formatting instead. For example, if we wanted words instead of number and the 4 digit year at the end we could use the following.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token builtin">format</span> <span class="token operator">=</span> <span class="token string">&quot;%a %b %d %H:%M:%S %Y&quot;</span>

today_str <span class="token operator">=</span> today<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;strftime:&apos;</span><span class="token punctuation">,</span> today_str<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>today_str<span class="token punctuation">)</span><span class="token punctuation">)</span>

today_date <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>today_str<span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;strptime:&apos;</span><span class="token punctuation">,</span> today_date<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token builtin">format</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>today_date<span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>strftime: Thu Apr 12 16:19:17 2018
&lt;class &apos;str&apos;&gt;
strptime: Thu Apr 12 16:19:17 2018
&lt;class &apos;datetime.datetime&apos;&gt;
</code></pre><p><code>strftime</code> converts a datetime object to a string and <code>strptime</code> creates a datetime object from a string. When you print them using the same format string, they look the same.</p>
<p>The format of the date fields (A04_start and A05_end) in the SAFI_farms.csv file have been generated automatically to comform to the <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a> standard.</p>
<p>When we read the file and extract the date fields, they are of type string. Before we can use them as dates, we need to convert them into Python date objects.</p>
<p>In the format string we use below, the <code>-</code> , <code>:</code> , <code>T</code> and <code>Z</code> characters are just that, characters in the string representing the date/time.<br>
Only the character preceded with <code>%</code> have special meanings.</p>
<p>Having converted the strings to datetime objects, there are a variety of methods that we can use to extract different components of the date/time.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime


<span class="token builtin">format</span> <span class="token operator">=</span> <span class="token string">&quot;%Y-%m-%dT%H:%M:%S.%fZ&quot;</span>
f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&apos;SAFI_farms.csv&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;r&apos;</span><span class="token punctuation">)</span>

<span class="token comment">#skip the header line</span>
line <span class="token operator">=</span> f<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># next line has data</span>
line <span class="token operator">=</span> f<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span>

strdate_start <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&apos;,&apos;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>  <span class="token comment"># A04_start</span>
strdate_end <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&apos;,&apos;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>    <span class="token comment"># A05_end</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>strdate_start<span class="token punctuation">)</span><span class="token punctuation">,</span> strdate_start<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>strdate_end<span class="token punctuation">)</span><span class="token punctuation">,</span> strdate_end<span class="token punctuation">)</span>


<span class="token comment"># the full date and time</span>
datetime_start <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>strdate_start<span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>datetime_start<span class="token punctuation">)</span><span class="token punctuation">)</span>
datetime_end <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>strdate_end<span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;formatted date and time&apos;</span><span class="token punctuation">,</span> datetime_start<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;formatted date and time&apos;</span><span class="token punctuation">,</span> datetime_end<span class="token punctuation">)</span>


<span class="token comment"># the date component</span>
date_start <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>strdate_start<span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token punctuation">)</span><span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>date_start<span class="token punctuation">)</span><span class="token punctuation">)</span>
date_end <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>strdate_end<span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token punctuation">)</span><span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;formatted start date&apos;</span><span class="token punctuation">,</span> date_start<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;formatted end date&apos;</span><span class="token punctuation">,</span> date_end<span class="token punctuation">)</span>

<span class="token comment"># the time component</span>
time_start <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>strdate_start<span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token punctuation">)</span><span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>time_start<span class="token punctuation">)</span><span class="token punctuation">)</span>
time_end <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>strdate_end<span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token punctuation">)</span><span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;formatted start time&apos;</span><span class="token punctuation">,</span> time_start<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;formatted end time&apos;</span><span class="token punctuation">,</span> time_end<span class="token punctuation">)</span>

f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>&lt;class &apos;str&apos;&gt; 2017-03-23T09:49:57.000Z
&lt;class &apos;str&apos;&gt; 2017-04-02T17:29:08.000Z
&lt;class &apos;datetime.datetime&apos;&gt;
formatted date and time 2017-03-23 09:49:57
formatted date and time 2017-04-02 17:29:08
&lt;class &apos;datetime.date&apos;&gt;
formatted start date 2017-03-23
formatted end date 2017-04-02
&lt;class &apos;datetime.time&apos;&gt;
formatted start time 09:49:57
formatted end time 17:29:08
</code></pre><h2 class="mume-header" id="components-of-dates-and-times">Components of dates and times</h2>

<p>For a date or time we can also extract individual components of them.<br>
They are held internally in the datetime datastructure.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># date parts.</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;formatted end date&apos;</span><span class="token punctuation">,</span> date_end<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos; end date year&apos;</span><span class="token punctuation">,</span> date_end<span class="token punctuation">.</span>year<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos; end date month&apos;</span><span class="token punctuation">,</span> date_end<span class="token punctuation">.</span>month<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos; end date day&apos;</span><span class="token punctuation">,</span> date_end<span class="token punctuation">.</span>day<span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>date_end<span class="token punctuation">.</span>day<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># time parts.</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;formatted end time&apos;</span><span class="token punctuation">,</span> time_end<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos; end time hour&apos;</span><span class="token punctuation">,</span> time_end<span class="token punctuation">.</span>hour<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos; end time minutes&apos;</span><span class="token punctuation">,</span> time_end<span class="token punctuation">.</span>minute<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos; end time seconds&apos;</span><span class="token punctuation">,</span> time_end<span class="token punctuation">.</span>second<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>time_end<span class="token punctuation">.</span>second<span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>formatted end date 2017-04-02
 end date year 2017
 end date month 4
 end date day 2
&lt;class &apos;int&apos;&gt;
formatted end time 17:29:08
 end time hour 17
 end time minutes 29
 end time seconds 8
&lt;class &apos;int&apos;&gt;
</code></pre><h2 class="mume-header" id="date-arithmetic">Date arithmetic</h2>

<p>We can also do arithmetic with the dates.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">date_diff <span class="token operator">=</span> datetime_end <span class="token operator">-</span> datetime_start
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;formatted date and time (start)&apos;</span><span class="token punctuation">,</span> datetime_start<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&apos;formatted date and time (end)&apos;</span><span class="token punctuation">,</span> datetime_end<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>datetime_start<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>date_diff<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>date_diff<span class="token punctuation">)</span>

date_diff <span class="token operator">=</span> datetime_start <span class="token operator">-</span> datetime_end
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>date_diff<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>date_diff<span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>formatted date and time (start) 2017-08-23 05:53:59
formatted date and time (end) 2017-08-23 06:04:39
&lt;class &apos;datetime.datetime&apos;&gt;
&lt;class &apos;datetime.timedelta&apos;&gt;
0:10:40
&lt;class &apos;datetime.timedelta&apos;&gt;
-1 day, 23:49:20
</code></pre><blockquote>
<h2>Exercise</h2>
<p>How do you interpret the last result?</p>
</blockquote>
<p>The code below calculates the time difference between supposedly starting the survey and ending the survey (for each respondent).</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime

<span class="token builtin">format</span> <span class="token operator">=</span> <span class="token string">&quot;%Y-%m-%dT%H:%M:%S.%fZ&quot;</span>

f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&apos;SAFI_farms.csv&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;r&apos;</span><span class="token punctuation">)</span>

line <span class="token operator">=</span> f<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>
    <span class="token comment">#print(line)</span>
    strdate_start <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&apos;,&apos;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>
    strdate_end <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&apos;,&apos;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span>

    datetime_start <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>strdate_start<span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token punctuation">)</span>
    datetime_end <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>strdate_end<span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token punctuation">)</span>
    date_diff <span class="token operator">=</span> datetime_end <span class="token operator">-</span> datetime_start
    <span class="token keyword">print</span><span class="token punctuation">(</span>datetime_start<span class="token punctuation">,</span> datetime_end<span class="token punctuation">,</span> date_diff <span class="token punctuation">)</span>


f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>2017-03-23 09:49:57 2017-04-02 17:29:08 10 days, 7:39:11
2017-04-02 09:48:16 2017-04-02 17:26:19 7:38:03
2017-04-02 14:35:26 2017-04-02 17:26:53 2:51:27
2017-04-02 14:55:18 2017-04-02 17:27:16 2:31:58
2017-04-02 15:10:35 2017-04-02 17:27:35 2:17:00
2017-04-02 15:27:25 2017-04-02 17:28:02 2:00:37
2017-04-02 15:38:01 2017-04-02 17:28:19 1:50:18
2017-04-02 15:59:52 2017-04-02 17:28:39 1:28:47
2017-04-02 16:23:36 2017-04-02 16:42:08 0:18:32
...
</code></pre><h2 class="mume-header" id="exercise-4">Exercise</h2>

<ol>
<li>
<p>In the <code>SAFI_farms.csv</code> file the <code>A01_interview_date</code> field, (index 2) contains a date in the form of &apos;dd/mm/yyyy&apos;. Read the file and calculate the differences in days (because the interview date is only given to the day) between the <code>A01_interview_date</code> values and the <code>A04_start</code> values. You will need to create a format string for the <code>A01_interview_date</code> field.</p>
</li>
<li>
<p>Looking at the results here and from the previous section of code. Do you think the use of the smartphone data entry system for the survey was being used in real time?</p>
</li>
</ol>
<details><summary><b>Solution</b>  - click me</summary>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime

format1 <span class="token operator">=</span> <span class="token string">&quot;%Y-%m-%dT%H:%M:%S.%fZ&quot;</span>
format2 <span class="token operator">=</span> <span class="token string">&quot;%d/%m/%Y&quot;</span>

f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&apos;SAFI_farms.csv&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;r&apos;</span><span class="token punctuation">)</span>

line <span class="token operator">=</span> f<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>
    A01 <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&apos;,&apos;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    A04 <span class="token operator">=</span> line<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&apos;,&apos;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>
   
    datetime_A04 <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>A04<span class="token punctuation">,</span> format1<span class="token punctuation">)</span>
    datetime_A01 <span class="token operator">=</span> datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>A01<span class="token punctuation">,</span> format2<span class="token punctuation">)</span>
    date_diff <span class="token operator">=</span> datetime_A04 <span class="token operator">-</span> datetime_A01
    <span class="token keyword">print</span><span class="token punctuation">(</span>datetime_A04<span class="token punctuation">,</span> datetime_A01<span class="token punctuation">,</span> date_diff<span class="token punctuation">.</span>days <span class="token punctuation">)</span>
     
f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre></details>
<br>
<h2 class="mume-header" id="more-on-dictionaries">More on Dictionaries</h2>

<p>In a previous episode we introduced the dictionary object.</p>
<p>We created dictionaries and we added <code>key : value</code> pairs to the dictionary.</p>
<p>In all of the examples that we used, the <code>value</code> was always a simple data type like an integer or a string.</p>
<p>The <code>value</code> associated with a <code>key</code> in a dictionary can be of any type including  a <code>list</code> or even another <code>dictionary</code>.</p>
<p>We created a simple dictionary object with the following code:</p>
<pre data-role="codeBlock" data-info="python" class="language-python">personDict <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&apos;Name&apos;</span> <span class="token punctuation">:</span> <span class="token string">&apos;Peter&apos;</span><span class="token punctuation">}</span>
personDict<span class="token punctuation">[</span><span class="token string">&apos;Location&apos;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&apos;Manchester&apos;</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>personDict<span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>{&apos;Name&apos;: &apos;Peter&apos;, &apos;Location&apos;: &apos;Manchester&apos;}
</code></pre><p>So far the keys in the dictionary each relate to a single piece of information about the person. What if we wanted to add a list of items?</p>
<pre data-role="codeBlock" data-info="python" class="language-python">personDict<span class="token punctuation">[</span><span class="token string">&apos;Children&apos;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&apos;John&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;Jane&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;Jack&apos;</span><span class="token punctuation">]</span>
personDict<span class="token punctuation">[</span><span class="token string">&apos;Children_count&apos;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">3</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>personDict<span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>{&apos;Name&apos;: &apos;Peter&apos;, &apos;Children&apos;: [&apos;John&apos;, &apos;Jane&apos;, &apos;Jack&apos;], &apos;Children_count&apos;: 3, &apos;Location&apos;: &apos;Manchester&apos;}
</code></pre><p>Not only can I have a key where the value is a list, the value could also be another dictionary object. Suppose I want to add some telephone numbers</p>
<pre data-role="codeBlock" data-info="python" class="language-python">personDict<span class="token punctuation">[</span><span class="token string">&apos;phones&apos;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&apos;home&apos;</span> <span class="token punctuation">:</span> <span class="token string">&apos;0102345678&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;mobile&apos;</span> <span class="token punctuation">:</span> <span class="token string">&apos;07770123456&apos;</span><span class="token punctuation">}</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>personDict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># adding another phone</span>
personDict<span class="token punctuation">[</span><span class="token string">&apos;phones&apos;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;business&apos;</span><span class="token punctuation">]</span> <span class="token operator">=</span>  <span class="token string">&apos;0161234234546&apos;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>personDict<span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>dict_values([&apos;Peter&apos;, [&apos;John&apos;, &apos;Jane&apos;, &apos;Jack&apos;], {&apos;home&apos;: &apos;0102345678&apos;, &apos;mobile&apos;: &apos;07770123456&apos;}, 3, &apos;Manchester&apos;])
{&apos;Name&apos;: &apos;Peter&apos;, &apos;Children&apos;: [&apos;John&apos;, &apos;Jane&apos;, &apos;Jack&apos;], &apos;phones&apos;: {&apos;home&apos;: &apos;0102345678&apos;, &apos;mobile&apos;: &apos;07770123456&apos;, &apos;business&apos;: &apos;0161234234546&apos;}, &apos;Children_count&apos;: 3, &apos;Location&apos;: &apos;Manchester&apos;}
</code></pre><h2 class="mume-header" id="exercise-5">Exercise</h2>

<ol>
<li>Using the personDict as a base add information relating to the persons home and work addresses including postcodes.</li>
<li>Print out the postcode for the work address.</li>
<li>Print out the names of the children on seperate lines (i.e. not as a list)</li>
</ol>
<details><summary><b>Solution</b>  - click me</summary>
<pre data-role="codeBlock" data-info="python" class="language-python">personDict<span class="token punctuation">[</span><span class="token string">&apos;Addresses&apos;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&apos;Home&apos;</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&apos;Addressline1&apos;</span> <span class="token punctuation">:</span> <span class="token string">&apos;23 acacia ave.&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;Addressline2&apos;</span> <span class="token punctuation">:</span> <span class="token string">&apos;Romford&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;PostCode&apos;</span> <span class="token punctuation">:</span> <span class="token string">&apos;RO6 5WR&apos;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                          <span class="token string">&apos;Work&apos;</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token string">&apos;Addressline1&apos;</span> <span class="token punctuation">:</span> <span class="token string">&apos;19 Orford Road.&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;Addressline2&apos;</span> <span class="token punctuation">:</span> <span class="token string">&apos;London&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;PostCode&apos;</span> <span class="token punctuation">:</span> <span class="token string">&apos;EC4J 3XY&apos;</span><span class="token punctuation">}</span>
                          <span class="token punctuation">}</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>personDict<span class="token punctuation">[</span><span class="token string">&apos;Addresses&apos;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;Work&apos;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;PostCode&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> child <span class="token keyword">in</span> personDict<span class="token punctuation">[</span><span class="token string">&apos;Children&apos;</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span>
</pre></details>
<br>
<p>The ability to create dictionaries containing lists and other dictionaries, makes the dictionary object very versatile, you can create an arbitrarily complex data structure of dictionaries within dictionaries.</p>
<p>In practice you will not be doing this manually, instead like most data you will read it in from a file.</p>
<h2 class="mume-header" id="the-json-data-format">The JSON data format</h2>

<p>The JSON data format was designed as a way of allowing different machines or processes within machines to communicate with each other by sending messages constructed in a well defined format. JSON is now the preferred data format used by APIs (Application Programming Interfaces).</p>
<p>The JSON format although somewhat verbose is not only Human readable but it can also be mapped very easily to a Python dictionary object.</p>
<p>We are going to read a file of data formatted as JSON, convert it into a dictionary object in Python then selectively extract Key-Value pairs and create a csv file from the extracted data.</p>
<p>The JSON file we are going to use is the <a href="data/SAFI.json">SAFI.json</a> file. This is the output file from an electronic survey system called ODK. The JSON represents the answers to a series of survey questions. The questions themselves have been replaced with unique Keys, the values are the answers.</p>
<p>Because detailed surveys are by nature nested structures making it possible to record different levels of detail or selectively ask a set of specific questions based on the answer given a previous question, the structure of the answers for the survey can not only be complex and convoluted, it could easily be different from one survey respondent&apos;s set of answers to another.</p>
<h3 class="mume-header" id="advantages-of-json">Advantages of JSON</h3>

<ul>
<li>Very popular data format for APIs (e.g. results from an Internet search)</li>
<li>Human readable</li>
<li>Each record (or document as they are called) is self contained. The equivalent of the column name and column values are in every record.</li>
<li>Documents do not all have to have the same structure within the same file</li>
<li>Document structures can be complex and nested</li>
</ul>
<h3 class="mume-header" id="dis-advantages-of-json">Dis-advantages of JSON</h3>

<ul>
<li>It is more verbose than the equivalent data in csv format</li>
<li>Can be more difficult to process and display than csv formatted data</li>
</ul>
<h2 class="mume-header" id="use-the-json-package-to-read-a-json-file">Use the JSON package to read a JSON file</h2>

<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">import</span> json

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&apos;SAFI.json&apos;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> json_data<span class="token punctuation">:</span>
    d <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>json_data<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>&lt;class &apos;list&apos;&gt;
&lt;class &apos;dict&apos;&gt;
{
  &quot;G02_months_lack_food&quot;: [
    &quot;Jan&quot;
  ],
  &quot;G01_no_meals&quot;: 2,
  &quot;E_no_group_count&quot;: &quot;2&quot;,
  &quot;A03_quest_no&quot;: &quot;01&quot;,
...
</code></pre><p>Points to note:</p>
<ol>
<li>We import the json package with an import statement.</li>
<li>We have chosen to use the <code>with</code> statement to open the SAFI.json file. Notice the <code>:</code> at the end of the line and the subsequent indentation. The <code>with</code> statement is in effect until we un-indent. At which time the file will automatically be closed. So we don&apos;t need to do so explicitly.</li>
<li>&apos;json_data&apos; is the file handle.</li>
<li>The <code>json.load</code> method is passed the file handle and reads the complete file.</li>
<li>The variable <code>d</code> is a list of dictionaries. (When we read the csv file we considered it to be a list of strings).</li>
<li>The <code>json.dumps</code> method can be used to print either the entire file or a specific dictionary from the list in a formatted manner by using the indent parameter)</li>
</ol>
<p>By default the order in which the keys of the dictionary are printed is not guaranteed. If we want them in sorted order we can have them sorted by using the <code>sort_keys</code> parameter</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> sort_keys<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>{
  &quot;A01_interview_date&quot;: &quot;2016-11-17&quot;,
  &quot;A03_quest_no&quot;: &quot;01&quot;,
  &quot;A04_start&quot;: &quot;2017-03-23T09:49:57.000Z&quot;,
  &quot;A05_end&quot;: &quot;2017-04-02T17:29:08.000Z&quot;,
  &quot;A06_province&quot;: &quot;province1&quot;,
...
}
</code></pre><h2 class="mume-header" id="extracting-specific-fields-from-a-json-document">Extracting specific fields from a JSON document</h2>

<p>If we want to extract fields from a JSON document, the first step is to convert the JSON document into a list of Python dictionaries. We have in fact already done this with the</p>
<pre data-role="codeBlock" data-info="python" class="language-python">d <span class="token operator">=</span> json<span class="token punctuation">.</span>load<span class="token punctuation">(</span>json_data<span class="token punctuation">)</span>
</pre><p>line. <code>d</code> a list object and each entry in the list is a Dictionary object.</p>
<h2 class="mume-header" id="extract-the-fields-we-want-into-a-flat-format">Extract the fields we want into a flat format</h2>

<p>Despite the arbitrary complexity of a JSON document or a Python dictionary object, we can adopt a very systematic approach to extracting individual fields form the structure.</p>
<p>The story so far: Our JSON file has been read into a variable <code>d</code>. We know that <code>d</code> is a list of dictionaries. Each dictionary represents a JSON document ( a record).</p>
<p>We can print the contents of the first dictionary in the list with</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> indent<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> sort_keys<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><h2 class="mume-header" id="exercise-6">Exercise</h2>

<ol>
<li>
<p>In the output from the code above there is a key with the name of <code>D_curr_crop</code>. Find it and by looking at the indentation and the <code>[</code> (lists) and <code>{</code> (dictionaries) describe in English how you could find the first occurrence of  <code>D_curr_crop</code> starting with <code>d</code>.</p>
</li>
<li>
<p>Use a print statement to find out what it is.</p>
</li>
</ol>
<details><summary><b>Solution</b>  - click me</summary>
<ul>
<li><code>d</code> is a list of dictionaries</li>
<li><code>d[0]</code> is the first dictionary</li>
<li>within <code>d[0]</code> there is a key <code>D_plots</code> whose value is a list and contains dictionaries</li>
<li><code>d[0][&apos;D_plots&apos;][0]</code> is the first dictionary in the list</li>
<li>within <code>d[0][&apos;D_plots&apos;][0]</code> there is a key <code>D_crops</code> which is also a list of dictionaries</li>
<li><code>d[0][&apos;D_plots&apos;][0][&apos;D_crops&apos;][0]</code> is the first dictionary in the list</li>
<li>within this dictionary there is a key <code>D_curr_crop</code></li>
</ul>
<p>Being able to start at the outermost level and work your way in is very important when you need to extract specific items.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;D_plots&apos;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;D_crops&apos;</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&apos;D_curr_crop&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</pre></details>
<br>
<p>Being able to drill down in this way is very useful in helping you get a feel for the JSON data structure. In practice it is more likely that instead of returning the first occurrence of <code>D_curr_crop</code> you will want to return all of them. This requires a little more programming and to be aware of two potential problems.</p>
<ol>
<li><code>D_curr_crop</code> may not exist in any particular dictionary within <code>D_crops</code></li>
<li>any of the lists <code>D_plots</code> or <code>D_crops</code> could be missing or just empty lists (<code>[]</code>)</li>
</ol>
<p>In our first attempt we will ignore these problems.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">for</span> farms <span class="token keyword">in</span> d<span class="token punctuation">:</span>
    plot <span class="token operator">=</span> farms<span class="token punctuation">[</span><span class="token string">&apos;D_plots&apos;</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> crops <span class="token keyword">in</span> plot<span class="token punctuation">:</span>
        crop <span class="token operator">=</span> crops<span class="token punctuation">[</span><span class="token string">&apos;D_crops&apos;</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> curr_crops <span class="token keyword">in</span> crop<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>curr_crops<span class="token punctuation">[</span><span class="token string">&apos;D_curr_crop&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>maize
maize
maize
tomatoes
vegetable
maize
maize
maize
sorghum
...
</code></pre><p>In this version we test if all of the keys exist.<br>
This could be extended to check that the lists are not empty.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">for</span> farms <span class="token keyword">in</span> d<span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token string">&apos;D_plots&apos;</span> <span class="token keyword">in</span> farms <span class="token punctuation">:</span>
        plot <span class="token operator">=</span> farms<span class="token punctuation">[</span><span class="token string">&apos;D_plots&apos;</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> crops <span class="token keyword">in</span> plot<span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token string">&apos;D_crops&apos;</span> <span class="token keyword">in</span> crops <span class="token punctuation">:</span>
                crop <span class="token operator">=</span> crops<span class="token punctuation">[</span><span class="token string">&apos;D_crops&apos;</span><span class="token punctuation">]</span>
                <span class="token keyword">for</span> curr_crops <span class="token keyword">in</span> crop<span class="token punctuation">:</span>
                    <span class="token keyword">if</span> <span class="token string">&apos;D_curr_crop&apos;</span> <span class="token keyword">in</span> curr_crops<span class="token punctuation">:</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span>curr_crops<span class="token punctuation">[</span><span class="token string">&apos;D_curr_crop&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</pre><p>We can now produce a list of all of the crops in all of the plots in all of the farms.</p>
<p>We can also create a unique set of all of the crops grown using the Python <code>set</code> data structure as shown in the code below. A set is like a list but does not allow duplicate values (but doesn&apos;t raise an error if you try to add a duplicate).</p>
<pre data-role="codeBlock" data-info="python" class="language-python">unique_crops <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> farms <span class="token keyword">in</span> d<span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token string">&apos;D_plots&apos;</span> <span class="token keyword">in</span> farms <span class="token punctuation">:</span>
        plot <span class="token operator">=</span> farms<span class="token punctuation">[</span><span class="token string">&apos;D_plots&apos;</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> crops <span class="token keyword">in</span> plot<span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token string">&apos;D_crops&apos;</span> <span class="token keyword">in</span> crops <span class="token punctuation">:</span>
                crop <span class="token operator">=</span> crops<span class="token punctuation">[</span><span class="token string">&apos;D_crops&apos;</span><span class="token punctuation">]</span>
                <span class="token keyword">for</span> curr_crops <span class="token keyword">in</span> crop<span class="token punctuation">:</span>
                    <span class="token keyword">if</span> <span class="token string">&apos;D_curr_crop&apos;</span> <span class="token keyword">in</span> curr_crops<span class="token punctuation">:</span>
                        <span class="token comment">#print(curr_crops[&apos;D_curr_crop&apos;])</span>
                        unique_crops<span class="token punctuation">.</span>add<span class="token punctuation">(</span>curr_crops<span class="token punctuation">[</span><span class="token string">&apos;D_curr_crop&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>unique_crops<span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>{&apos;peanut&apos;, &apos;potatoes&apos;, &apos;tomatoes&apos;, &apos;other&apos;, &apos;vegetable&apos;, &apos;amendoim&apos;, &apos;sunflower&apos;, &apos;bananas&apos;, &apos;sesame&apos;, None, &apos;cucumber&apos;, &apos;onion&apos;, &apos;sorghum&apos;, &apos;piri_piri&apos;, &apos;baby_corn&apos;, &apos;cabbage&apos;, &apos;ngogwe&apos;, &apos;maize&apos;, &apos;pigeonpeas&apos;, &apos;beans&apos;}
</code></pre><p>Simply having a list of all of the crops is unlikely to be enough. What you are really interested in is which farm grows which crops in which plot.</p>
<p>We can accumulate this information as we move through the list of dictionary objects. At the top level, <code>farm</code>, there is a unique identifier <code>instanceID</code> which we can use. for the plot and the crop within the plot we will create our own simple indexing system (<code>plot_no</code> and <code>crop_no</code>). At the end instead of just printing the crop name, we also print the details of where this crop is being grown.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">for</span> farms <span class="token keyword">in</span> d<span class="token punctuation">:</span>
    plot_no <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> farms<span class="token punctuation">[</span><span class="token string">&apos;instanceID&apos;</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token string">&apos;D_plots&apos;</span> <span class="token keyword">in</span> farms <span class="token punctuation">:</span>
        plot <span class="token operator">=</span> farms<span class="token punctuation">[</span><span class="token string">&apos;D_plots&apos;</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> crops <span class="token keyword">in</span> plot<span class="token punctuation">:</span>
            crop_no <span class="token operator">=</span> <span class="token number">0</span>
            plot_no <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token keyword">if</span> <span class="token string">&apos;D_crops&apos;</span> <span class="token keyword">in</span> crops <span class="token punctuation">:</span>
                crop <span class="token operator">=</span> crops<span class="token punctuation">[</span><span class="token string">&apos;D_crops&apos;</span><span class="token punctuation">]</span>
                <span class="token keyword">for</span> curr_crops <span class="token keyword">in</span> crop<span class="token punctuation">:</span>
                    crop_no <span class="token operator">+=</span> <span class="token number">1</span>
                    <span class="token keyword">if</span> <span class="token string">&apos;D_curr_crop&apos;</span> <span class="token keyword">in</span> curr_crops<span class="token punctuation">:</span>
                        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Farm no &quot;</span><span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">,</span><span class="token string">&quot; grows &quot;</span><span class="token punctuation">,</span> curr_crops<span class="token punctuation">[</span><span class="token string">&apos;D_curr_crop&apos;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">&quot; in plot&quot;</span><span class="token punctuation">,</span> plot_no <span class="token punctuation">,</span> <span class="token string">&quot; and it is crop number &quot;</span><span class="token punctuation">,</span> crop_no<span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>Farm  uuid:ec241f2c-0609-46ed-b5e8-fe575f6cefef  grows  maize  in plot 1  and it is crop number  1
Farm  uuid:ec241f2c-0609-46ed-b5e8-fe575f6cefef  grows  maize  in plot 2  and it is crop number  1
Farm  uuid:099de9c9-3e5e-427b-8452-26250e840d6e  grows  maize  in plot 1  and it is crop number  1
Farm  uuid:099de9c9-3e5e-427b-8452-26250e840d6e  grows  tomatoes  in plot 2  and it is crop number  1
Farm  uuid:099de9c9-3e5e-427b-8452-26250e840d6e  grows  vegetable  in plot 3  and it is crop number  1
Farm  uuid:193d7daf-9582-409b-bf09-027dd36f9007  grows  maize  in plot 1  and it is crop number  1
...
</code></pre><p>The final stage of this data extraction process is to save the extracted data to a file for subsequent use.</p>
<p>Rather than manually appending all of the information items into a string with <code>,</code> seperating each, we can use the <code>csv</code> module.</p>
<p>To do this we need to create a <code>csv.writer</code> object and use it to write complete rows of data at a time. <code>csv.writer</code> expects the data to be provided as a list of items.</p>
<p>For the header row we provide a list of strings containing the colmn names we want and at the end we proivide the data items in a list as well.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">import</span> csv
filename <span class="token operator">=</span> <span class="token string">&quot;data/SAFI_crops.csv&quot;</span>
fw <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">&apos;w&apos;</span><span class="token punctuation">)</span>
cf <span class="token operator">=</span> csv<span class="token punctuation">.</span>writer<span class="token punctuation">(</span>fw<span class="token punctuation">,</span> lineterminator<span class="token operator">=</span><span class="token string">&apos;\n&apos;</span><span class="token punctuation">)</span>

<span class="token comment"># write the header</span>
cf<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;Farm&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;plot_no&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;plot_area&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;crop_no&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;crop_name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> farms <span class="token keyword">in</span> d<span class="token punctuation">:</span>
    plot_no <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token builtin">id</span> <span class="token operator">=</span> farms<span class="token punctuation">[</span><span class="token string">&apos;instanceID&apos;</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token string">&apos;D_plots&apos;</span> <span class="token keyword">in</span> farms <span class="token punctuation">:</span>
        plot <span class="token operator">=</span> farms<span class="token punctuation">[</span><span class="token string">&apos;D_plots&apos;</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> crops <span class="token keyword">in</span> plot<span class="token punctuation">:</span>
            crop_no <span class="token operator">=</span> <span class="token number">0</span>
            plot_no <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token keyword">if</span> <span class="token string">&apos;D_crops&apos;</span> <span class="token keyword">in</span> crops <span class="token punctuation">:</span>
                plot_area <span class="token operator">=</span> crops<span class="token punctuation">[</span><span class="token string">&apos;D02_total_plot&apos;</span><span class="token punctuation">]</span>
                crop <span class="token operator">=</span> crops<span class="token punctuation">[</span><span class="token string">&apos;D_crops&apos;</span><span class="token punctuation">]</span>
                <span class="token keyword">for</span> curr_crops <span class="token keyword">in</span> crop<span class="token punctuation">:</span>
                    crop_no <span class="token operator">+=</span> <span class="token number">1</span>
                    <span class="token keyword">if</span> <span class="token string">&apos;D_curr_crop&apos;</span> <span class="token keyword">in</span> curr_crops<span class="token punctuation">:</span>
                        <span class="token comment">#print( id, plot_no , plot_area , crop_no, curr_crops[&apos;D_curr_crop&apos;])</span>
                        cf<span class="token punctuation">.</span>writerow<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">id</span><span class="token punctuation">,</span> plot_no <span class="token punctuation">,</span> plot_area <span class="token punctuation">,</span> crop_no<span class="token punctuation">,</span> curr_crops<span class="token punctuation">[</span><span class="token string">&apos;D_curr_crop&apos;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

fw<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><h2 class="mume-header" id="what-is-pandas">What is Pandas?</h2>

<p>pandas is a Python library containing a set of functions and specialised data structures that have been designed to help Python programmers to perform data analysis tasks in a structured way.</p>
<p>Most of the things that pandas can do can be done with basic Python, but the collected set of pandas functions and data structure makes the data analysis tasks more consistent in terms of syntax and therefore aids readabilty.</p>
<p>Particular features of pandas that we will be looking at over this and the next couple of episodes include:</p>
<ul>
<li>Reading data stored in CSV files (other file formats can be read as well)</li>
<li>Slicing and subsetting data in Dataframes (tables!)</li>
<li>Dealing with missing data</li>
<li>Reshaping data (long -wide,  wide -long)</li>
<li>Inserting and deleting columns from data structures</li>
<li>Aggregating data using data grouping facilities using the split-apply-combine paradigm</li>
<li>Joining of datasets (after they have been loaded into Dataframes)</li>
</ul>
<p>If you are wondering why I write pandas with a lower case &apos;p&apos; it is because it is the name of the package and Python is case sensitive.</p>
<h2 class="mume-header" id="importing-the-pandas-library">Importing the pandas library</h2>

<p>Importing the pandas library is done in exactly the same way as for any other library. In almost all examples of Python code using the pandas library, it will have been imported and given an alias of <code>pd</code>. We will follow the same convention.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
</pre><h2 class="mume-header" id="pandas-data-structures">Pandas data structures</h2>

<p>There are two main data structure used by pandas, they are the Series and the Dataframe. The Series equates in general to a vector or a list. The Dataframe is equivalent to a table. Each column in a pandas Dataframe is a pandas Series data structure.</p>
<p>We will mainly be looking at the Dataframe.</p>
<p>We can easily create a Pandas Dataframe by reading a .csv file</p>
<h2 class="mume-header" id="reading-a-csv-file">Reading a csv file</h2>

<p>When we read a csv dataset in base Python we did so by opening the dataset, reading and processing a record at a time and then closing the dataset after we had read the last record. Reading datasets in this way is slow and places all of the responsibility for extracting individual data items of information from the records on the programmer.</p>
<p>The main advantage of this approach, however, is that you only have to store one dataset record in memory at a time. This means that if you have the time, you can process datasets of any size.</p>
<p>In Pandas, csv files are read as complete datasets. You do not have to explicitly open and close the dataset. All of the dataset records are assembled into a Dataframe. If your dataset has column headers in the first record then these can be used as the Dataframe column names. You can explicitly state this in the parameters to the call, but pandas is usually able to infer that there ia a header row and use it automatically.</p>
<p>We are going to read in our SAFI_farms.csv file. Although this is a tab delimited file we will still use the pandas <code>read_csv</code> method, but we will explicitly tell the method that the separator is the tab character and not a comma which is the default.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_farms <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;data/SAFI_farms.csv&quot;</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">&apos;,&apos;</span><span class="token punctuation">)</span>
</pre><p>In the call of the <code>read_csv</code> method we explicitly indicated the value of the <code>sep</code> parameter as a comma. Not surprisingly a comma is the default value for this parameter and we could have simply omitted it. The existence of the <code>sep</code> parameter allows us to use the same method for reading csv-like files without needing a whole new method.</p>
<p>For example in some countries csv files are written with &apos;;&apos; instead of &apos;,&apos;. We can also use the same method to read <code>tab</code> delimited files. In this case we indicatee the tab character with <code>sep=&apos;\t&apos;</code>. the &apos;&apos; is known as the escape character and is used to indicate that whatever follows it is to be treated in a special way. In this case the &apos;t&apos; is to be treated as the tab character rather than the letter &apos;t&apos;.</p>
<h2 class="mume-header" id="exercise-7">Exercise</h2>

<p>What happens if you incorrectly specify <code>sep</code> parameter?  Try it and see.</p>
<details><summary><b>Solution</b>  - click me</summary>
<pre data-role="codeBlock" data-info="python" class="language-python">df_farms_oops <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;data/SAFI_farms.csv&quot;</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">&apos;\t&apos;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms_oops<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms_oops<span class="token punctuation">)</span>
</pre><p>If you allow pandas to assume that your columns are separated by tab characters and there aren&apos;t any, then each record will be treated as a single column. So the shape is given as 350 rows (correct) but only one column.</p>
<p>When the contents is displayed the only column name is the complete first record.</p>
</details>
<br>
<h2 class="mume-header" id="getting-information-about-a-dataframe">Getting information about a Dataframe</h2>

<p>You can find out the type of the variable <code>df_farms</code> by using the <code>type</code> function.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>&lt;class &apos;pandas.core.frame.DataFrame&apos;&gt;
</code></pre><pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">)</span>
</pre><p>You can see the contents by simply entering the variable name or uysing the <code>print</code> statement. You can see from the output that it is a tabular format. The column names have been taken from the first record of the file. On the left hand side is a column with no name. The entries here have been provided by pandas and act as an index to reference the individual rows of the Dataframe.</p>
<p>The <code>read_csv()</code> function has an <code>index_col</code> parameter which you can use to indicate which of the columns in the file you wish to use as the index instead. As the farms dataset doesn&apos;t have a convenient column which would uniquely identify each row we choose not to do do that.</p>
<p>Another thing to notice about the display is that it is truncated. By default you will see the first and last 30 rows. For the columns you will always get the first few columns and typically the last few depending on display space.</p>
<p>Similar information can be obtained with <code>df_farms.head()</code> But here you are only returned the first 5 rows by default.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_farms<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><blockquote>
<h2>Exercise</h2>
<ol>
<li>As well as the <code>head()</code> method there is a <code>tail()</code> method. What do you think it does? Try it.</li>
<li>Both methods accept a single numeric parameter. What do you think it does? Try it.</li>
</ol>
</blockquote>
<p>You can obtain other basic information about your Dataframe of data with:</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># How many rows?</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># How many rows and columns - returned as a tuple</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>

<span class="token comment">#How many &apos;cells&apos; in the table</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">.</span>size<span class="token punctuation">)</span>

<span class="token comment"># What are the column names</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>

<span class="token comment"># what are the data types of the columns?</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">.</span>dtypes<span class="token punctuation">)</span>

</pre><pre data-role="codeBlock" data-info class="language-"><code>350
(350, 61)
21350
Index([&apos;Id&apos;, &apos;Country&apos;, &apos;A01_interview_date&apos;, &apos;A03_quest_no&apos;, &apos;A04_start&apos;,
       &apos;A05_end&apos;, &apos;A06_province&apos;, &apos;A07_district&apos;, &apos;A08_ward&apos;, &apos;A09_village&apos;,
       &apos;A11_years_farm&apos;, &apos;A12_agr_assoc&apos;, &apos;B_no_membrs&apos;, &apos;_members_count&apos;,
       &apos;B11_remittance_money&apos;, &apos;B16_years_liv&apos;, &apos;B17_parents_liv&apos;,
       &apos;B18_sp_parents_liv&apos;, &apos;B19_grand_liv&apos;, &apos;B20_sp_grand_liv&apos;,
       &apos;C01_respondent_roof_type&apos;, &apos;C02_respondent_wall_type&apos;,
       &apos;C03_respondent_floor_type&apos;, &apos;C04_window_type&apos;,
       &apos;C05_buildings_in_compound&apos;, &apos;C06_rooms&apos;, &apos;C07_other_buildings&apos;,
       &apos;D_no_plots&apos;, &apos;D_plots_count&apos;, &apos;E01_water_use&apos;, &apos;E_no_group_count&apos;,
       &apos;E_yes_group_count&apos;, &apos;E17_no_enough_water&apos;, &apos;E18_months_no_water&apos;,
       &apos;E19_period_use&apos;, &apos;E20_exper_other&apos;, &apos;E21_other_meth&apos;, &apos;E22_res_change&apos;,
       &apos;E23_memb_assoc&apos;, &apos;E24_resp_assoc&apos;, &apos;E25_fees_water&apos;,
       &apos;E26_affect_conflicts&apos;, &apos;F04_need_money&apos;, &apos;F05_money_source&apos;,
       &apos;F05_money_source_other&apos;, &apos;F08_emply_lab&apos;, &apos;F09_du_labour&apos;,
       &apos;F10_liv_owned&apos;, &apos;F10_liv_owned_other&apos;, &apos;F_liv_count&apos;, &apos;F12_poultry&apos;,
       &apos;F13_du_look_aftr_cows&apos;, &apos;F14_items_owned&apos;, &apos;G01_no_meals&apos;,
       &apos;G02_months_lack_food&apos;, &apos;G03_no_food_mitigation&apos;, &apos;gps:Latitude&apos;,
       &apos;gps:Longitude&apos;, &apos;gps:Altitude&apos;, &apos;gps:Accuracy&apos;, &apos;instanceID&apos;],
      dtype=&apos;object&apos;)
Id                      int64
Country                object
A01_interview_date     object
A03_quest_no            int64
A04_start              object
                       ...   
gps:Latitude          float64
gps:Longitude         float64
gps:Altitude          float64
gps:Accuracy          float64
instanceID             object
Length: 61, dtype: object

</code></pre><h2 class="mume-header" id="exercise-8">Exercise</h2>

<p>When we asked for the column names, the output was abridged, i.e. we didn&apos;t get the values for all of the columns. Can you write a small piece of code which will return all of the values</p>
<details><summary><b>Solution</b>  - click me</summary>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">for</span> name <span class="token keyword">in</span> df_farms<span class="token punctuation">.</span>columns<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
</pre></details>
<br>
<h2 class="mume-header" id="selecting-rows-and-columns-from-a-pandas-dataframe">Selecting rows and columns from a pandas Dataframe</h2>

<p>If we know which columns we want before we read the data from the file we can tell <code>read_csv()</code> to only import those columns by specifying columns either by their index number (starting at 0) as a list to the <code>usecols</code> parameter. Alternatively we can also provide a list of column names.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_farms_some_cols <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&apos;data/SAFI_farms.csv&apos;</span><span class="token punctuation">,</span> usecols<span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms_some_cols<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms_some_cols<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
df_farms_some_cols <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&apos;data/SAFI_farms.csv&apos;</span><span class="token punctuation">,</span> usecols<span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&apos;Id&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;Country&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;A01_interview_date&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;C01_respondent_roof_type&apos;</span><span class="token punctuation">,</span>
       <span class="token string">&apos;C02_respondent_wall_type&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;C03_respondent_floor_type&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms_some_cols<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>(350, 6)
Index([&apos;Id&apos;, &apos;Country&apos;, &apos;A01_interview_date&apos;, &apos;C01_respondent_roof_type&apos;,
       &apos;C02_respondent_wall_type&apos;, &apos;C03_respondent_floor_type&apos;],
      dtype=&apos;object&apos;)
Index([&apos;Id&apos;, &apos;Country&apos;, &apos;A01_interview_date&apos;, &apos;C01_respondent_roof_type&apos;,
       &apos;C02_respondent_wall_type&apos;, &apos;C03_respondent_floor_type&apos;],
      dtype=&apos;object&apos;)
</code></pre><p>Let us assume for now that we read in the complete file which is now in the Dataframe <code>df_farms</code>, how can we now refer to specific columns?</p>
<p>There are two ways of doing this using the column names (or labels):</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># Both of these statements are the same</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">[</span><span class="token string">&apos;Id&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># and</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">.</span>Id<span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>0        1
1        2
2        3
3        4
4        5
      ... 
345    346
346    347
347    348
348    349
349    350
Name: Id, Length: 350, dtype: int64
...
</code></pre><p>If we are interested in more than one column, the 2nd method above cannot be used. However in the first, although we used a string with the value of <code>&apos;Id&apos;</code> we could also have provided a list of strings. Remember that lists are enclosed in <code>[]</code>.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&apos;Id&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;Country&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;A01_interview_date&apos;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>      Id Country A01_interview_date
0      1     Moz         17/11/2016
1      2     Moz         17/11/2016
2      3     Moz         17/11/2016
3      4     Moz         17/11/2016
4      5     Moz         17/11/2016
..   ...     ...                ...
345  346     Moz         22/08/2017
346  347     Moz         22/08/2017
347  348     Moz         22/08/2017
348  349     Moz         22/08/2017
349  350     Moz         22/08/2017

[350 rows x 3 columns]
</code></pre><h2 class="mume-header" id="exercise-9">Exercise</h2>

<p>What happens if you:</p>
<ol>
<li>List the columns you want out of order from the way they appear in the file?</li>
<li>Put the same column name in twice?</li>
<li>Put in a non-existing column name? (a.k.a Typo)</li>
</ol>
<details><summary><b>Solution</b>  - click me</summary>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&apos;A01_interview_date&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;Country&apos;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&apos;A01_interview_date&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;Country&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;A01_interview_date&apos;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&apos;A02_interview_date&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;Country&apos;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</pre></details>
<br>
<h2 class="mume-header" id="filtering-by-rows">Filtering by Rows</h2>

<p>You can filter the Dataframe by rows by specifying a range in the form of <code>a:b</code>. <code>a</code> is the first row and <code>b</code> is one beyond the last row required.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># select row with index of 1, 2 and 3 (rows 2, 3 and 4 in the Dataframe)</span>
df_farms_some_rows <span class="token operator">=</span> df_farms<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>
df_farms_some_rows
</pre><h2 class="mume-header" id="exercise-10">Exercise</h2>

<p>What happens if we ask for a single row instead of a range?</p>
<details><summary><b>Solution</b>  - click me</summary>
<pre data-role="codeBlock" data-info="python" class="language-python">df_farms<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
</pre><p>You get an error if you only specify <code>1</code>. You need to use <code>:1</code> or <code>0:1</code> to get the first row returned. The <code>:</code> is always required. You can use <code>:</code> by itself to return all of the rows.</p>
</details>
<br>
<h2 class="mume-header" id="using-criteria-to-filter-rows">Using criteria to filter rows</h2>

<p>It is more likely that you will want to select rows from the Dataframe based on some criteria, such as &quot;all rows where the value for A01_interview_date is &apos;21/11/2016&apos;.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_farms_some_rows <span class="token operator">=</span> df_farms<span class="token punctuation">[</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">.</span>A01_interview_date <span class="token operator">==</span> <span class="token string">&apos;21/11/2016&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
df_farms_some_rows
</pre><p>The criteria can be more complex and isn&apos;t limited to a single column&apos;s values:</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_farms_some_rows <span class="token operator">=</span> df_farms<span class="token punctuation">[</span> <span class="token punctuation">(</span>df_farms<span class="token punctuation">.</span>A01_interview_date <span class="token operator">==</span> <span class="token string">&apos;21/11/2016&apos;</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df_farms<span class="token punctuation">.</span>A09_village <span class="token operator">==</span> <span class="token string">&apos;God&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
df_farms_some_rows
</pre><p>We can combine the row selection with column selection:</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_farms_some_rows <span class="token operator">=</span> df_farms<span class="token punctuation">[</span> <span class="token punctuation">(</span>df_farms<span class="token punctuation">.</span>B_no_membrs <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df_farms<span class="token punctuation">.</span>A11_years_farm <span class="token operator">&lt;</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&apos;Id&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;Country&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;A01_interview_date&apos;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
df_farms_some_rows
</pre><p>Selecting rows on the row index is of limited use unless you need to select a contiguous range of rows.</p>
<p>There is however another way of selecting rows using the row index:</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_farms_some_rows <span class="token operator">=</span> df_farms<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>
df_farms_some_rows
</pre><p>Using the <code>iloc</code> method gives the same results as our previous example.</p>
<p>However, now we can specify a single value and more importantly we can use the <code>range()</code> function to indicate the records that we want. This can be useful for making pseudo-random selections of rows from across the Dataframe.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># Select the first row from the Dataframe</span>
df_farms_some_rows <span class="token operator">=</span> df_farms<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
df_farms_some_rows
<span class="token comment"># select every 100th record from the Dataframe.</span>
df_farms_some_rows <span class="token operator">=</span> df_farms<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
df_farms_some_rows
</pre><p>You can also specify column ranges using the <code>iloc</code> method again using the column index numbers:</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># columns 0,1,2 and 3</span>
df_farms_some_rows <span class="token operator">=</span> df_farms<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>
df_farms_some_rows
<span class="token comment"># columns 0,1,2,21 and 22</span>
df_farms_some_rows <span class="token operator">=</span> df_farms<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
df_farms_some_rows
</pre><p>There is also a <code>loc</code> method which allows you to use the column names.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># columns 0,1,2,21 and 22 using the column names and changing &apos;iloc&apos; to &apos;loc&apos;</span>
df_farms_some_rows <span class="token operator">=</span> df_farms<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">&apos;Id&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;Country&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;A01_interview_date&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;C02_respondent_wall_type&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;C03_respondent_floor_type&apos;</span> <span class="token punctuation">]</span><span class="token punctuation">]</span>
df_farms_some_rows
</pre><h2 class="mume-header" id="sampling">Sampling</h2>

<p>Pandas does have a <code>sample</code> method which allows you to extract a sample of the records from the Dataframe.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_farms<span class="token punctuation">.</span>sample<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> replace<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>             <span class="token comment"># ten records, do not select same record twice (this is the default)</span>
df_farms<span class="token punctuation">.</span>sample<span class="token punctuation">(</span>frac<span class="token operator">=</span><span class="token number">0.05</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>     <span class="token comment"># 5% of records , same records if run again</span>
</pre><h2 class="mume-header" id="using-pandas-functions-to-summarise-data-in-a-data-frame">Using Pandas functions to summarise data in a Data Frame</h2>

<p>For variables which contain numerical values we are often interested in various statistical measures relating to those values. For categorical variable we are often interested in the how many of each unique values are present in the dataset.</p>
<p>We shall use the SAFI_results.csv dataset to demonstrate how we can obtain these pieces of information</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
df_farms <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;data/SAFI_farms.csv&quot;</span><span class="token punctuation">)</span>
df_farms
</pre><p>For numeric variables we can obtain a variety of basic statistical information by using the <code>describe()</code> method.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_farms<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><p>This can be done for the Dataframe as a whole, in which case some of the results might have no sensible meaning. If there are any missing values, represented in the display as <code>NaN</code> you will get a warning message.</p>
<p>You can also <code>.describe()</code> on a single variable basis.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_farms<span class="token punctuation">[</span><span class="token string">&apos;B_no_membrs&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><p>There are also a set of methods which allow us to obtain individual values.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">[</span><span class="token string">&apos;B_no_membrs&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">[</span><span class="token string">&apos;B_no_membrs&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">[</span><span class="token string">&apos;B_no_membrs&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">[</span><span class="token string">&apos;B_no_membrs&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">[</span><span class="token string">&apos;B_no_membrs&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">[</span><span class="token string">&apos;B_no_membrs&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>1
19
6.325714285714286
2.8268405376491903
350
2214
</code></pre><p>Unlike the <code>describe()</code> method which converts the variable to a float (when it was originally an integer), the individual summary methods only does so for the returned result if needed.</p>
<p>We can do the same thing for the <code>E19_period_use</code> variable</p>
<pre data-role="codeBlock" data-info class="language-"><code>print(df_farms[&apos;E19_period_use&apos;].min())
print(df_farms[&apos;E19_period_use&apos;].max())
print(df_farms[&apos;E19_period_use&apos;].mean())
print(df_farms[&apos;E19_period_use&apos;].std())
print(df_farms[&apos;E19_period_use&apos;].count())
print(df_farms[&apos;E19_period_use&apos;].sum())
</code></pre><pre data-role="codeBlock" data-info class="language-"><code>1.0
50.0
11.727272727272727
9.88040630066518
275
3225.0

</code></pre><h2 class="mume-header" id="exercise-11">Exercise</h2>

<p>Compare the count values returned for the <code>B_no_membrs</code> and the <code>E19_period_use</code> variables.</p>
<ol>
<li>Why do you think they are different?</li>
<li>How does this affect the calculation of the mean values?</li>
</ol>
<details><summary><b>Solution</b>  - click me</summary>
<p>We know from when we originally displayed the contents of the <code>df_farms</code> Dataframe that there are 350 rows in it. This matches the value for the <code>B_no_membrs</code> count. The count for <code>E19_period_use</code> however is only 275. If you look at the values in the <code>E19_period_use</code> column using</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_farms<span class="token punctuation">[</span><span class="token string">&apos;E19_period_use&apos;</span><span class="token punctuation">]</span>
</pre><p>you will see that there are several <code>NaN</code> values. They also occurred when we used <code>describe()</code> on the full Dataframe. <code>NaN</code> stands for Not a Number, ie. the value is missing. There are only 275 non-missing values and this is what is reported by the <code>count()</code> method. This value is also used in the calculation of the mean and std values.</p>
</details>
<br>
<h2 class="mume-header" id="dealing-with-missing-values">Dealing with missing values</h2>

<p>We can find out how many variables in our Dataframe contains any <code>NaN</code> values with the code</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_farms<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>Column1                             0
A01_interview_date                  0
A03_quest_no                        0
A04_start                           0
...
</code></pre><p>Unfortunately as the display is truncated it doesn&apos;t tell us much. You can however get the value for a specific column</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_farms<span class="token punctuation">[</span><span class="token string">&apos;E19_period_use&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>75
</code></pre><p>or you could write a small chunk of code to make sure all of the values are printed.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">null_count <span class="token operator">=</span> df_farms<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
col_name <span class="token operator">=</span> df_farms<span class="token punctuation">.</span>columns
<span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>col_name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>col_name<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">,</span> null_count<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span> 
</pre><p>Data from most sources has the potential to include missing data. Whether or not this presents a problem at all depends on what you are planning to do.</p>
<p>The SAFI dataset we have been using comes from a project called &apos;Studying African Farmer-led Irrigation&apos;. The data for this project is questionnaire based, but rather than using a paper-based questionnaire, it has been created and is completed electronically via an app on a smartphone. This provides flexibility in the design and presentation of the questionnaire; a section of the questionnaire may only be presented depending on the answer given to some preceding question. This means that there can quite legitimately be a set of &apos;NaN&apos; values in a record (one complete questionnaire) where you would still consider the record to be complete.</p>
<p>We have already seen how we can check for missing values. There are three other actions we need to be able to do:</p>
<ol>
<li>Remove complete rows which contain <code>NaN</code></li>
<li>Replace <code>NaN</code> with a value of our choice</li>
<li>Replace specific values with <code>NaN</code></li>
</ol>
<p>With these options we can ensure that the data is suitable for the further processing we have planned.</p>
<h3 class="mume-header" id="completely-remove-rows-with-nans">Completely remove rows with NaNs</h3>

<p>The <code>dropna()</code> method will delete all rows if <em>any</em> of the variables contain an <code>NaN</code>. For some datasets this may be acceptable. You will need to take care that you have enough rows left for your analysis to have meaning.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_farms <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;data/SAFI_farms.csv&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
df_farms<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>(350, 61)
(0, 61)
</code></pre><p>Because there are variables in the SAFI dataset which are all <code>NaN</code> using the <code>dropna()</code> method effectively deletes all of the rows from the Dataframe, probably not what you wanted. Instead we can use the <code>notnull()</code> method as a row selection criteria and delete the rows where a specific variable has <code>NaN</code> values.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_farms <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;data/SAFI_farms.csv&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
df_farms <span class="token operator">=</span> df_farms<span class="token punctuation">[</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">[</span><span class="token string">&apos;E_no_group_count&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>notnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>(350, 61)
(75, 61)
</code></pre><h3 class="mume-header" id="replace-nan-with-a-value-of-our-choice">Replace NaN with a value of our choice</h3>

<p>The <code>E19_period_use</code> variable answers the question: &quot;For how many years have you been irrigating the land?&quot;. In some cases the land is not irrigated and these are represented by NaN in the dataset. So when we run</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_farms <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;data/SAFI_farms.csv&quot;</span><span class="token punctuation">)</span>
df_farms<span class="token punctuation">[</span><span class="token string">&apos;E19_period_use&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><p>we get a count value of 275 and all of the other statistics are based on this count value.</p>
<p>Now supposing that instead of NaN the interviewer entered a value of 0 to indicate the land which is <em>not</em> irrigated has been irrigated for 0 years, technically correct.</p>
<p>To see what happens we can convert all of the NaN values in the <code>E19_period_use</code> column to 0 with the following code:</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_farms<span class="token punctuation">[</span><span class="token string">&apos;E19_period_use&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
</pre><p>If we now run the <code>describe()</code> again you can see that all of the statistic have been changed because the calculations are NOW based on a count of 350. Probably not what we would have wanted.</p>
<p>Conveniently this allows us to demonstrate our 3rd action.</p>
<h3 class="mume-header" id="replace-specific-values-with-nan">Replace specific values with NaN</h3>

<p>Although we can recognise <code>NaN</code> with methods like <code>isnull()</code> or <code>dropna()</code> actually creating a <code>NaN</code> value and putting it into a Dataframe, requires the <code>numpy</code> module. The following code will replace our 0 values with <code>NaN</code>. We can demonstrate that this has occurred by running the <code>describe()</code> again and see that we now have our original values back.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
df_farms<span class="token punctuation">[</span><span class="token string">&apos;E19_period_use&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> np<span class="token punctuation">.</span>NaN<span class="token punctuation">,</span> inplace <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
df_farms<span class="token punctuation">[</span><span class="token string">&apos;E19_period_use&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><h2 class="mume-header" id="categorical-variables">Categorical variables</h2>

<p>For categorical variables, numerical statistics don&apos;t make any sense.<br>
For a categorical variable we can obtain a list of unique values used by the variable by using the <code>unique()</code> method.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_farms <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;data/SAFI_farms.csv&quot;</span><span class="token punctuation">)</span>
pd<span class="token punctuation">.</span>unique<span class="token punctuation">(</span>df_farms<span class="token punctuation">[</span><span class="token string">&apos;C01_respondent_roof_type&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info class="language-"><code>array([&apos;grass&apos;, &apos;mabatisloping&apos;, &apos;mabatipitched&apos;], dtype=object)
</code></pre><p>Knowing all of the unique values is useful but what is more useful is knowing how many occurrences of each there are. In order to do this we can use the <code>groupby</code> method.</p>
<p>Having performed the <code>groupby()</code> we can them <code>describe()</code> the results. The format is similar to that which we have seen before except that the &apos;grouped by&apos; variable appears to the left and there is a set of statistics for each unique value of the variable.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">grouped_data <span class="token operator">=</span> df_farms<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&apos;C01_respondent_roof_type&apos;</span><span class="token punctuation">)</span>
grouped_data<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><p>You can group by more than one variable at a time by providing them as a list.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">grouped_data <span class="token operator">=</span> df_farms<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&apos;C01_respondent_roof_type&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;C02_respondent_wall_type&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
grouped_data<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><p>You can also obtain individual statistics if you want.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">A11_years_farm <span class="token operator">=</span> df_farms<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&apos;C01_respondent_roof_type&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;C02_respondent_wall_type&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&apos;A11_years_farm&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>
A11_years_farm
</pre><pre data-role="codeBlock" data-info class="language-"><code>C01_respondent_roof_type  C02_respondent_wall_type
grass                     burntbricks                  31
                          muddaub                     109
                          sunbricks                    72
mabatipitched             burntbricks                   6
                          cement                        1
                          muddaub                       3
                          sunbricks                     2
mabatisloping             burntbricks                  97
                          cement                        5
                          muddaub                       5
                          sunbricks                    19
Name: A11_years_farm, dtype: int64
</code></pre><h2 class="mume-header" id="exercise-12">Exercise</h2>

<blockquote></blockquote>
<ol>
<li>Read in the SAFI_farms.csv dataset.</li>
<li>Get a list of the different <code>C01_respondent_roof_type</code> values.</li>
<li>Groupby <code>C01_respondent_roof_type</code> and describe the results.</li>
<li>Remove rows with NULL values for <code>E_no_group_count</code>.</li>
<li>repeat steps 2 &amp; 3 and compare the results.</li>
</ol>
<blockquote></blockquote>
<details><summary><b>Solution</b>  - click me</summary>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># Steps 1 and 2</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
df_farms <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;data/SAFI_farms.csv&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>unique<span class="token punctuation">(</span>df_farms<span class="token punctuation">[</span><span class="token string">&apos;C01_respondent_roof_type&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># Step 3</span>
grouped_data <span class="token operator">=</span> df_farms<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&apos;C01_respondent_roof_type&apos;</span><span class="token punctuation">)</span>
grouped_data<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># steps 4 and 5</span>
df_farms <span class="token operator">=</span> df_farms<span class="token punctuation">[</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">[</span><span class="token string">&apos;E_no_group_count&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>notnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
grouped_data <span class="token operator">=</span> df_farms<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&apos;C01_respondent_roof_type&apos;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>unique<span class="token punctuation">(</span>df_farms<span class="token punctuation">[</span><span class="token string">&apos;C01_respondent_roof_type&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
grouped_data<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><p><code>E_no_group_count</code> is related to whether or not farm plots are irrigated or not. It has no obvious connection to farm buildings.<br>
By restricting the data to non-irrigated plots we have accidentally? removed one of the roof_types completely.</p>
</details>
<br>
<h2 class="mume-header" id="joining-dataframes">Joining Dataframes</h2>

<h3 class="mume-header" id="why-do-we-want-to-do-this">Why do we want to do this</h3>

<p>There are many occasions when we have related data spread across multiple files.</p>
<p>The data can be related to each other in different ways. How they are related and how completely we can join the data from the datasets will vary.</p>
<p>In this episode we will consider different scenarios and show we might join the data. We will use csv files and in all cases the first step will be to read the datasets into a pandas Dataframe from where we will do the joining. The csv files we are using are the <code>farms.csv</code> file that we have used before and two other data files from the same SAFI project; <code>plots.csv</code> (details of the plots relating to a given farm) and <code>crops.csv</code> (details of crops grown in the plots).</p>
<p>You can probably see from the brief descriptions of these files that you would expect relationships to exist between them. Farms have plots (fields) and in the fields, crops are grown;</p>
<p>Joins are used to combine the columns from two (or more) tables together to form a single table. A join between tables will only be possible if they have at least one column in common. The column doesn&apos;t have to have the same name in each table, and quite often they won&#x2019;t, but they do have to have a common usage.</p>
<h2 class="mume-header" id="exercise-13">Exercise</h2>

<ol>
<li>Read in the three datasets into pandas dataframes with name of <code>df_farms</code>, <code>df_plots</code> and <code>df_crops</code>.</li>
<li>Examine the data using the <code>head()</code> and <code>shape</code> functions.</li>
<li>What can we discover about how we might <code>join</code> the tables and the nature of the the relationships between the tables?</li>
</ol>
<details><summary><b>Solution</b>  - click me</summary>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

<span class="token comment"># read the files</span>
df_farms <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;data/SAFI_farms.csv&quot;</span><span class="token punctuation">)</span>
df_plots <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;data/SAFI_plots.csv&quot;</span><span class="token punctuation">)</span>
df_crops <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;data/SAFI_crops.csv&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># quick check of the data</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_plots<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_plots<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_crops<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_crops<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
</pre><p>The <code>df_farms</code> dataframe is just as we have seen before there are 350 rows and the first column (<code>Id</code>) is a unique identifier representing the Farm.</p>
<p>In the <code>df_plots</code> dataframe, there is again an <code>Id</code> column, additionally there is a <code>plot_Id</code> column. There are 844 rows in the dataframe.</p>
<p>In the <code>df_crops</code> dataframe, there is a an <code>Id</code> column a <code>plot_Id</code> column and a <code>crop_Id</code> column. There are 1044 rows in the dataframe.</p>
</details>
<br>
<p>Given our SAFI tables we may pose the following question: Which Farms with more than 12 people in the household grow Maize? No single table has the answer to this question.</p>
<p>We can get part of the answer from the <code>df_farms</code> dataframe;</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_farms<span class="token punctuation">[</span>df_farms<span class="token punctuation">[</span><span class="token string">&apos;B_no_membrs&apos;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">12</span><span class="token punctuation">]</span>
</pre><p>and part from the <code>df_crops</code> dataframe;</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_crops<span class="token punctuation">[</span>df_crops<span class="token punctuation">[</span><span class="token string">&apos;D_curr_crop&apos;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&apos;maize&apos;</span><span class="token punctuation">]</span>
</pre><p>But the answer to the question as a whole requires that the data from the two tables be joined together, based on the the common <code>Id</code> column first and then the two conditions applied.</p>
<p>We can join the two dataframes using the Pandas <code>merge</code> method.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_farms_crops <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df_farms<span class="token punctuation">,</span> df_crops<span class="token punctuation">,</span> how<span class="token operator">=</span><span class="token string">&apos;inner&apos;</span><span class="token punctuation">,</span> on <span class="token operator">=</span> <span class="token string">&apos;Id&apos;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms_crops<span class="token punctuation">)</span>
</pre><p>The result of the operation is un-surprisingly a dataframe. The only two parameters needed by the <code>merge</code> method is the two dataframes to be joined.</p>
<p>The <code>on</code> parameter specifies the column name common to both dataframes that we wish to join <a href="http://on.In">on.In</a> our case the only option is the <code>Id</code> column so we could have left it out and the <code>merge</code> method would have assumed it.</p>
<p>There will be many circumstances in which although there is a column in both table on which you can perform the join, they have different names. In these cases you can use the <code>left_on</code> and <code>right_on</code> parameters.</p>
<p>The <code>how</code> parameter specifies the type of join you wish to perform. An <code>inner</code> join is the default as this is by far the most common join you will want to use. There are however several other join types available which we will discuss shortly.</p>
<p>An inner join will return a row for every match between the joining columns in the two dataframes. As each row in the <code>crops</code> dataframe has an Id which appears in the <code>farms</code> dataframe we end up with 1044 rows in the resulting dataframe.</p>
<h2 class="mume-header" id="exercise-14">Exercise</h2>

<ol>
<li>
<p>Join the <code>farms</code> dataframe with the <code>plots</code> dataframe using an inner join on the <code>Id</code> column. How many rows are returned?<br>
can you explain this number?</p>
</li>
<li>
<p>Join the <code>plots</code> dataframe with the <code>crops</code> dataframe using an inner join on the <code>Id</code> column. What crops are grown in the plots of <code>Id</code> 355?</p>
</li>
</ol>
<details><summary><b>Solution</b>  - click me</summary>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># 1</span>
df_farms_plots <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df_farms<span class="token punctuation">,</span> df_plots<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_farms_plots<span class="token punctuation">)</span>

<span class="token comment"># 2</span>

df_plots_crops <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df_plots<span class="token punctuation">,</span> df_crops<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>df_plots_crops<span class="token punctuation">)</span>

</pre><p>In the first join 817 rows are returned, not 844 which is the number of plots. This is because the plots dataframe includes <code>Id</code>s which are not in the <code>farms</code> dataframe. as there is no match, no row is returned.</p>
<p>For the same reason, although you get 1044 rows returned in the second join, because all of the <code>Id</code>s in the <code>crops</code> dataframe match <code>Id</code>s in the <code>plots</code> dataframe, the <code>crops</code> dataframe does not contain any <code>Id</code>s above 350 so, although we have plots with an <code>Id</code> of 355, we do not have the associated crop information.</p>
</details>
<br>
<p>In order to completely understand how two datasets might be related we need to make use of the other types of joines which are available to us. These are listed below.</p>
<h2 class="mume-header" id="there-are-several-different-join-types-possible">There are several different join types possible</h2>

<table>
<thead>
<tr>
<th>Join Type</th>
<th style="text-align:left">What it does</th>
</tr>
</thead>
<tbody>
<tr>
<td>Inner Join (<code>how=&apos;inner&apos;</code>)</td>
<td style="text-align:left">Matched rows in both tables are returned</td>
</tr>
<tr>
<td>Left outer join (<code>how=&apos;left&apos;</code>)</td>
<td style="text-align:left">All row in the left hand table are returned along with the matches from the right hand table or NULLs if there is no match</td>
</tr>
<tr>
<td>Right outer join (<code>how=&apos;right&apos;</code>)</td>
<td style="text-align:left">All row in the right hand table are returned along with the matches from the left hand table or NULLs if there is no match</td>
</tr>
<tr>
<td>Full outer join (<code>how=&apos;outer&apos;</code>)</td>
<td style="text-align:left">All rows from both tables are returned, with NULLs where there are no matches</td>
</tr>
</tbody>
</table>
<h2 class="mume-header" id="exercise-15">Exercise</h2>

<p>Create a dataframe from the <code>farms</code> dataframe in which only has records for E01_water_use = yes and another where E01_water _use = no</p>
<p>Before performing the joins below, try to anticipate the results based on the join type and how the two dataframes have been created.</p>
<ol>
<li>perform a <code>Inner Join</code> between the <code>plot</code> and <code>crops</code> dataframes and check what is returned.</li>
<li>perform a <code>Left Outer Join</code> between the <code>plot</code> and <code>crops</code> dataframes and check what is returned.</li>
<li>perform a <code>Right Outer Join</code> between the <code>plot</code> and <code>crops</code> dataframes and check what is returned.</li>
<li>perform a <code>Full Outer Join</code> between the <code>plot</code> and <code>crops</code> dataframes and check what is returned.</li>
</ol>
<details><summary><b>Solution</b>  - click me</summary>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># Create the dataframes</span>

df_water_yes <span class="token operator">=</span> df_farms<span class="token punctuation">[</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">[</span><span class="token string">&apos;E01_water_use&apos;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&apos;yes&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
df_water_yes<span class="token punctuation">.</span>shape

df_water_no <span class="token operator">=</span> df_farms<span class="token punctuation">[</span><span class="token punctuation">(</span>df_farms<span class="token punctuation">[</span><span class="token string">&apos;E01_water_use&apos;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&apos;no&apos;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
df_water_no<span class="token punctuation">.</span>shape

<span class="token comment"># Perform the joins</span>

df_merge_water_inner <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df_water_yes<span class="token punctuation">,</span> df_water_no<span class="token punctuation">,</span> how <span class="token operator">=</span> <span class="token string">&apos;inner&apos;</span><span class="token punctuation">,</span> on <span class="token operator">=</span> <span class="token string">&apos;Id&apos;</span><span class="token punctuation">)</span>
df_merge_water_inner<span class="token punctuation">.</span>shape

df_merge_water_left <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df_water_yes<span class="token punctuation">,</span> df_water_no<span class="token punctuation">,</span> how <span class="token operator">=</span> <span class="token string">&apos;left&apos;</span><span class="token punctuation">,</span> on <span class="token operator">=</span> <span class="token string">&apos;Id&apos;</span><span class="token punctuation">)</span>
df_merge_water_left<span class="token punctuation">.</span>shape

df_merge_water_right <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df_water_yes<span class="token punctuation">,</span> df_water_no<span class="token punctuation">,</span> how <span class="token operator">=</span> <span class="token string">&apos;right&apos;</span><span class="token punctuation">,</span> on <span class="token operator">=</span> <span class="token string">&apos;Id&apos;</span><span class="token punctuation">)</span>
df_merge_water_right<span class="token punctuation">.</span>shape

df_merge_water_outer <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df_water_yes<span class="token punctuation">,</span> df_water_no<span class="token punctuation">,</span> how <span class="token operator">=</span> <span class="token string">&apos;outer&apos;</span><span class="token punctuation">,</span> on <span class="token operator">=</span> <span class="token string">&apos;Id&apos;</span><span class="token punctuation">)</span>
df_merge_water_outer<span class="token punctuation">.</span>shape
</pre></details>
<br>
<h2 class="mume-header" id="other-ways-to-combine-dataframes">Other ways to combine dataframes</h2>

<p>Because of the way we created the two dataframes for the last exercise, you may have realised that their contents were mutualy exclusive with respects to the <code>farms</code> dataframe. Using  the <code>Full Outer Join</code> in the previous exercise we did recover all of the data from the <code>farms</code> dataframe but the format is not quite as we might have wanted.</p>
<p>Really all we wanted to do was to concatenate the contents of the two dataframes together. I.e. add all of the rows in both into a single dataframe but without duplicating the column names.</p>
<p>Fortunately pandas has a method for that - <code>concat</code></p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_all_rows <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df_water_yes<span class="token punctuation">,</span> df_water_no<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&apos;Id&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df_all_rows
</pre><h2 class="mume-header" id="wide-and-long-data-formats">Wide and long data formats</h2>

<p>In the <code>farms</code> dataset that we have been using there some columns containing categorical values. I.e. there is a limited number of different values which can appear. The &quot;C01_respondent_roof_type&quot; column only contains one of three different values.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
df_farms <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&apos;./data/SAFI_farms.csv&apos;</span><span class="token punctuation">)</span>
df_farms<span class="token punctuation">.</span>C01_respondent_roof_type<span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><p>There are occasions when it is more useful to have this data as columns in their own right rather than values in a single column. Aggregations for example.</p>
<p>So instead of</p>
<p><img src="./fig/long.png" alt="long"></p>
<p>we want the data to look like this</p>
<p><img src="./fig/wide.png" alt="wide"></p>
<p>Pandas provides methods for converting data from <em>long</em> to <em>wide</em> format and from <em>wide</em> to <em>long</em> format.</p>
<p>For our example we will use the <code>harvests.csv</code> dataset. In  the current harvests file the number of harvests for each crop in each farm is given.</p>
<p>As most farms grow more than one crop there are multiple entries for each farm. We want to change this so that there is only one row for each farm, there is a column for each of the possible crops and values for each of the crops grown on the farm. The dataset does not contain rows for crops not grown. But this isn&apos;t really missing data, we are quite justified in giving a value of 0 for a crop not grown.</p>
<p>Before we do the conversion we shall have a little look at the contents of the dataset</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_harvests <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&apos;./data/harvests.csv&apos;</span><span class="token punctuation">)</span>
df_harvests<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
</pre><p>we can use either of these lines to find out what different crops are grown.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_harvests<span class="token punctuation">.</span>D_curr_crop<span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span>
df_harvests<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&apos;D_curr_crop&apos;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&apos;havests&apos;</span><span class="token punctuation">]</span>
</pre><p>The harvests dataframe is currently in <code>long</code> format and we wish to change it to <code>wide</code> format.</p>
<p>To do this we will use the pandas <code>pivot</code> method.</p>
<p>In order to use the pivot method we need three pieces of information.</p>
<ol>
<li>a column or columns which will remain fixed  - in our case this will be the<code>Id</code> column which represents the farm.</li>
<li>The column of categorigal values which are list of what will be the new column names - in our case this will be the <code>D_curr_crop</code> column</li>
<li>a column which contains the values to be stored in each of the new column names - in our case this will be the <code>havests</code> column</li>
</ol>
<p>We will create a new dataframe to contain the results</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_harvests_wide <span class="token operator">=</span> df_harvests<span class="token punctuation">.</span>pivot<span class="token punctuation">(</span>index <span class="token operator">=</span> <span class="token string">&apos;Id&apos;</span><span class="token punctuation">,</span> columns <span class="token operator">=</span> <span class="token string">&apos;D_curr_crop&apos;</span><span class="token punctuation">,</span> values <span class="token operator">=</span> <span class="token string">&apos;havests&apos;</span><span class="token punctuation">)</span>
df_harvests_wide<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><p>The result is a dataframe looking like this:</p>
<p><img src="./fig/harvests_wide_1.png" alt="harvests wide 1"></p>
<p>There are 3 things we need to clean up.</p>
<ol>
<li>
<p>The main blocks of <code>NaN</code>s was expected and we just want to change these all to 0 to indicate that this farm did not grow this crop.</p>
</li>
<li>
<p>The <code>Id</code> column has been made the Index column for the dataframe. This isn&apos;t really a problem as long as we remeber the fact in subsequent processing, but in this case we will change it back to a normal column.</p>
</li>
<li>
<p>The final problem is the column name of <code>NaN</code> we weren&apos;t really expecting this. We need to investigate further.</p>
</li>
</ol>
<p>As it is shown as a column name it must have appeared as a crop name in the <code>D_curr_crop</code> column? Well not quite, <code>NaN</code> is just the external manifestation of missing data. What it is really saying is that there is some missing data in the <code>D_curr_crop</code> column</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_harvests<span class="token punctuation">[</span><span class="token string">&apos;D_curr_crop&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><p>From this you can see that there are 5 missing values in this column.</p>
<p>You may have also noticed from the list of values in the <code>D_curr_crop</code> column that there appears to be a crop called <code>other</code>. This isn&apos;t a real crop and we don&apos;t have the data to say what the other crop is.  So in both of these cases we will change the values to &apos;Unknown Crop&apos;.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># Change the values in the missing data and the &apos;other&apos;s to &apos;Unknown Crop&apos;</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
df_harvests<span class="token punctuation">[</span><span class="token string">&apos;D_curr_crop&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span>np<span class="token punctuation">.</span>NaN<span class="token punctuation">,</span> <span class="token string">&apos;Unknown Crop&apos;</span><span class="token punctuation">,</span>  inplace <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
df_harvests<span class="token punctuation">[</span><span class="token string">&apos;D_curr_crop&apos;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&apos;other&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;Unknown Crop&apos;</span><span class="token punctuation">,</span> inplace <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># Create the wide version</span>
df_harvests_wide <span class="token operator">=</span> df_harvests<span class="token punctuation">.</span>pivot<span class="token punctuation">(</span>index <span class="token operator">=</span> <span class="token string">&apos;Id&apos;</span><span class="token punctuation">,</span> columns <span class="token operator">=</span> <span class="token string">&apos;D_curr_crop&apos;</span><span class="token punctuation">,</span> values <span class="token operator">=</span> <span class="token string">&apos;havests&apos;</span><span class="token punctuation">)</span>

<span class="token comment"># Reset the index</span>
df_harvests_wide<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>level<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># Change all of the `NaN`s to 0</span>
df_harvests_wide<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># we will export the result so that we can look at it in Excel</span>
df_harvests_wide<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">&quot;harvests_wide.csv&quot;</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

df_harvests_wide<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><h2 class="mume-header" id="wide-to-long">Wide to Long</h2>

<p>Now that we have a Wide version we  can use it to demonstrate how to convert wide to long.  To do this we will use the <code>melt</code> method.</p>
<p>For the <code>melt</code> method we will provide three parameters</p>
<p><code>id_vars</code> : the column (or columns) which stays the same - in our case the <code>Id</code> column<br>
<code>value_vars</code> : the list of columns which need to be &apos;unpivoted&apos; - in our case all of the other columns<br>
<code>value_name</code> : A column name for the values - in our case we have gone back to the original of &apos;harvests&apos;</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># create a list for the value_vars parameter; All but the &apos;Id&apos; column &apos;</span>
crop_list <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>df_harvests_wide<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
crop_list<span class="token punctuation">.</span>remove<span class="token punctuation">(</span><span class="token string">&apos;Id&apos;</span><span class="token punctuation">)</span>

<span class="token comment">#df_harvests_long = pd.melt(df_harvests_wide, id_vars = [&apos;Id&apos;], value_vars = crop_list)</span>

df_harvests_long <span class="token operator">=</span> df_harvests_wide<span class="token punctuation">.</span>melt<span class="token punctuation">(</span>id_vars <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&apos;Id&apos;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> value_vars <span class="token operator">=</span> crop_list<span class="token punctuation">,</span> value_name <span class="token operator">=</span> <span class="token string">&apos;harvests&apos;</span><span class="token punctuation">)</span>
df_harvests_long<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
</pre><p>The wide to long conversion is completed, but the result is too long!</p>
<p>We have a row for each crop for each farm even if it wasn&apos;t grown there. So as a final step we need to remove these rows.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_harvests_long <span class="token operator">=</span> df_harvests_long<span class="token punctuation">[</span><span class="token punctuation">(</span>df_harvests_long<span class="token punctuation">.</span>harvests  <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
df_harvests_long<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
</pre><h2 class="mume-header" id="exercise-16">Exercise</h2>

<ol>
<li>
<p>Compare the <code>df_harvests_long</code> with the original <code>df_harvests</code>. Can you explain the discrepency in the number of rows?</p>
</li>
<li>
<p>Using the <code>C01_respondent_roof_type</code> column in the <code>farms.csv</code> file create a wide version which just contains the <code>Id</code> column and columns for the different roof types. The values in the columns should be either <code>True</code> or <code>False</code>.</p>
</li>
</ol>
<details><summary><b>Solution</b>  - click me</summary>
<ol>
<li>We didn&apos;t allow for the possibility that in the original data a crop could be listed with &apos;0&apos; harvests.</li>
</ol>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># 2</span>
<span class="token comment"># read in the dataset, just the columns of interest.</span>
df_rooftype <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&apos;./data/SAFI_farms.csv&apos;</span><span class="token punctuation">,</span> usecols <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&apos;Id&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;C01_respondent_roof_type&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># add a column to use as values and set the values to True</span>
df_rooftype<span class="token punctuation">[</span><span class="token string">&apos;roofs&apos;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">True</span>

<span class="token comment"># Create the wide version</span>
df_roofs_wide <span class="token operator">=</span> df_rooftype<span class="token punctuation">.</span>pivot<span class="token punctuation">(</span>index <span class="token operator">=</span> <span class="token string">&apos;Id&apos;</span><span class="token punctuation">,</span> columns <span class="token operator">=</span> <span class="token string">&apos;C01_respondent_roof_type&apos;</span><span class="token punctuation">,</span> values <span class="token operator">=</span> <span class="token string">&apos;roofs&apos;</span><span class="token punctuation">)</span>

<span class="token comment"># Reset the index</span>
df_roofs_wide<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>level<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># Change all of the `NaN`s to False</span>
df_roofs_wide<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

<span class="token comment"># we will export the result so that we can look at it in Excel</span>
df_roofs_wide<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">&quot;roofs_wide.csv&quot;</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

df_roofs_wide<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre></details>
<br>
<h2 class="mume-header" id="matplotlib">Matplotlib</h2>

<p>Matplotlib is a Python graphical library that can be used to produce a variety of different graph types.</p>
<p>The pandas library contains very tight integration with matplotlib. There are functions in pandas that automatically call matplotlib functions to produce graphs.</p>
<p>Although we are using Matplotlib in this episode, pandas can make use of several other graphical libraries available from within Python such as ggplot2 and seaborn.</p>
<h2 class="mume-header" id="importing-matplotlib">Importing matplotlib</h2>

<p>The matplotlib library can be imported using any of the import techniques we have seen. As <code>pandas</code> is generally imported with <code>import panas as pd</code>, you will find that <code>matplotlib</code> is most commonly imported with <code>import matplotlib as plt</code> where &apos;plt&apos; is the alias.</p>
<p>In addition to importing the library, in a Jupyter notebook environment we need to tell Jupyter that when we produce a graph we want it to be display the graph in a cell in the notebook just like any other results. To do this we use the <code>%matplotlib inline</code> directive.</p>
<p>If you forget to do this, you will have to add <code>plt.show()</code> to see the graphs.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token operator">%</span>matplotlib inline
</pre><h2 class="mume-header" id="numpy">Numpy</h2>

<p>Numpy is another Python library. It is used for multi-dimensional array processing. In our case we just want to use it for its useful random number generation functions which we will use to create some fake data to demonstrate some of the graphing functions of matplotlib.</p>
<p>We will use the alias <code>np</code>, following convention.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
</pre><h2 class="mume-header" id="bar-charts">Bar charts</h2>

<pre data-role="codeBlock" data-info="python" class="language-python">np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>
</pre><p>will generate 20 random numbers between 0 and 1.</p>
<p>We are using these to create a pandas Series of values.</p>
<p>A bar chart only needs a single set of values. Each &apos;bar&apos; represents the value from the Series of values.<br>
A pandas Series (and a Dataframe) have a method called &apos;plot&apos;. We only need to tell plot what kind of graph we want.</p>
<p>The &apos;x&apos; axis represents the index values of the Series</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd

np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">12345</span><span class="token punctuation">)</span>            <span class="token comment"># set a seed value to ensure reproducibility of the plots</span>
s <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
<span class="token comment">#s</span>
<span class="token comment"># plot the bar chart</span>
s<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">&apos;bar&apos;</span><span class="token punctuation">)</span>
</pre><p>Internally the pandas &apos;plot&apos; method has called the &apos;bar&apos; method of matplotlib and provided a set of parameters, including the pandas.Series s to generate the graph.</p>
<p>We can use matplotlib directly to produce a similar graph. In this case we need to pass two parameters, the number of bars we need and the pandas Series holding the values.</p>
<p>We also have to explicitly call the <code>show()</code> function to produce the graph.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><h2>Exercise</h2>
<p>Compare the two graphs we have just drawn. How do they differ? Are the differences significant?</p>
<details><summary><b>Solution</b>  - click me</summary>
<p>Most importantly the data in the graphs is the same. There are cosmetic differentces in the scale points in the x and y axis and in the width of the bars.</p>
<p>The width of the bars can be changed with the <code>width</code> parameter in the &apos;bar&apos; function. We can also change the labels or scale on the x axis with the <code>tick_label</code> parameter.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">,</span> tick_label <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span> 
</pre></details>
<br>
<h2 class="mume-header" id="histograms">Histograms</h2>

<p>We can plot histograms in a similar way, directly from pandas and also from Matplotlib</p>
<p>The pandas way</p>
<pre data-role="codeBlock" data-info="python" class="language-python">s <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># plot the bar chart</span>
s<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">&apos;hist&apos;</span><span class="token punctuation">)</span>
</pre><p>and the matplotlib way</p>
<pre data-role="codeBlock" data-info="python" class="language-python">plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><p>For the Histogram, each data point is allocated to 1 of 10 (by default) equal &apos;bins&apos; of equal size (range of numbers) which are indicated along the x axis and the number of points (frequency) is shown on the y axis.</p>
<p>In this case the graphs are almost identical. The only difference being in the first graph the y axis has a label &apos;Frequency&apos; associated with it.</p>
<p>We can fix this with a call to the <code>ylabel</code> function</p>
<pre data-role="codeBlock" data-info="python" class="language-python">plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&apos;Frequency&apos;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>hist<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><p>In general most graphs can be broken down into a series of elements which, although typically related in some way, can all exist independently of each other. This allows us to create the graph in a rather piecemeal fashion.</p>
<p>The labels (if any) on the x and y axis are independent of the data values being represented. The title and the legend are also independent objects within the overall graph.</p>
<p>In matplotlib you create the graph by providing values for all of the individual components you choose to include. When you are ready, you call the <code>show</code> function.</p>
<p>Using this same approach we can plot two sets of data on the same graph</p>
<p>We will use a scatter plot to demonstrate some of the available features.</p>
<p>For a scatter plot we need two sets of data points one for the x values and the other for the y values.</p>
<h2 class="mume-header" id="scatter-plot">Scatter plot</h2>

<p>The scatter plot requires the x and y coordinates of each of the points being plotted.<br>
To provide this we will generate two series of random data one for the x coordinates and the other for the y coordinates</p>
<p>We will generate two sets of points and plot them on the same graph.</p>
<p>We will also add other common features like a title, a legend and labels on the x and y axis.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># Generate some date for 2 sets of points.</span>
x1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.5</span> <span class="token punctuation">)</span>
y1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.5</span> <span class="token punctuation">)</span>

x2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token punctuation">)</span>
y2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token punctuation">)</span>


<span class="token comment"># Add some features</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&apos;Scatter Plot&apos;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&apos;Range of y values&apos;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&apos;Range of x values&apos;</span><span class="token punctuation">)</span>

<span class="token comment"># plot the points in a scatter plot</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x1<span class="token punctuation">,</span>y1<span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">&apos;red&apos;</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&apos;Red Range&apos;</span> <span class="token punctuation">)</span>  <span class="token comment"># &apos;c&apos; parameter is the colour and &apos;label&apos; is the text for the legend</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x2<span class="token punctuation">,</span>y2<span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">&apos;blue&apos;</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&apos;Blue Range&apos;</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span> loc<span class="token operator">=</span><span class="token number">4</span> <span class="token punctuation">)</span>  <span class="token comment"># the locations 1,2,3 and 4 are top-right, top-left, bottom-left and bottom-right</span>
<span class="token comment"># Show the graph with the two sets of points</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><p>In the call to the <code>scatter</code> method, the <code>label</code> parameter values are used by the <em>legend</em>.<br>
The <code>c</code> or <code>color</code> parameter can be set to any color matplotlib recognises. Full details of the available colours are available in the <a href="http://matplotlib.org/api/colors_api.html">matplotlib</a> website. The <a href="http://matplotlib.org/api/markers_api.html">markers</a> section will tell you what markers you can use instead of the default &apos;dots&apos;. There is also an <code>s</code> (size) parameter which allows you to change the size of the marker.</p>
<h2 class="mume-header" id="exercise-17">Exercise</h2>

<p>In the scatterplot the s parameter determines the size of the dots. s can be a simple numeric value, say s=100, which will produce dots all of the same size. However you can pass a list of values (or a pandas Series) to provide sizes for the individual dots. This approach is very common as it allows us to provide an extra variable worth of information on the graph.</p>
<ol>
<li>
<p>Modify the code we used for the scatter plot to include a size value for each of the points in the series being plotted. (The downside is that some of the smaller dots may be completely covered by the larger dots. To try and highlight when this has happened we can change the opacity of the dots.)</p>
</li>
<li>
<p>Find out which parameter controls the opacity of the dots ( clue - it is not called opacity), add it to you code and set it to a reasonable value.</p>
</li>
</ol>
<details><summary><b>Solution</b>  - click me</summary>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># Generate some data for 2 sets of points.</span>
<span class="token comment"># and additional data for the sizes - suitably scaled</span>
x1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.5</span> <span class="token punctuation">)</span>
y1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0.5</span> <span class="token punctuation">)</span>
z1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">200</span> <span class="token punctuation">)</span>

x2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token punctuation">)</span>
y2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">0.5</span> <span class="token punctuation">)</span>
z2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">200</span> <span class="token punctuation">)</span>

<span class="token comment"># Add some features</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&apos;Scatter Plot&apos;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&apos;Range of y values&apos;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&apos;Range of x values&apos;</span><span class="token punctuation">)</span>

<span class="token comment"># plot the points in a scatter plot</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x1<span class="token punctuation">,</span>y1<span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">&apos;red&apos;</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&apos;Red Range&apos;</span><span class="token punctuation">,</span> s<span class="token operator">=</span>z1<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span> <span class="token punctuation">)</span>  <span class="token comment"># &apos;s&apos; parameter is the dot size</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x2<span class="token punctuation">,</span>y2<span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">&apos;blue&apos;</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">&apos;Blue Range&apos;</span><span class="token punctuation">,</span> s<span class="token operator">=</span>z2<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span> <span class="token comment"># &apos;alpha&apos; is the opacity</span>

plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span> loc<span class="token operator">=</span><span class="token number">4</span> <span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre></details>
<br>
<h2 class="mume-header" id="boxplot">Boxplot</h2>

<p>A boxplot provides a simple representation of a variety of statistical qualities of a single set of data values.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">x <span class="token operator">=</span> pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>standard_normal<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># Show a boxplot of the data</span>
plt<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><p>A common use of the boxplot is to compare the statistical variations across a set of variables.</p>
<p>The variables can be an independent series or columns of a Dataframe.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">&apos;ABCDE&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># creating a Dataframe directly with pandas</span>
plt<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>df<span class="token punctuation">.</span>A<span class="token punctuation">,</span> labels <span class="token operator">=</span> <span class="token string">&apos;A&apos;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><h2 class="mume-header" id="exercise-18">Exercise</h2>

<p>Can you change the code above so that columns <code>A</code> , <code>C</code> and <code>D</code> are all displayed on the same graph?</p>
<details><summary><b>Solution</b>  - click me</summary>
<pre data-role="codeBlock" data-info="python" class="language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">&apos;ABCDE&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span><span class="token punctuation">[</span>df<span class="token punctuation">.</span>A<span class="token punctuation">,</span> df<span class="token punctuation">.</span>C<span class="token punctuation">,</span> df<span class="token punctuation">.</span>D<span class="token punctuation">]</span><span class="token punctuation">,</span> labels <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&apos;A&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;C&apos;</span><span class="token punctuation">,</span> <span class="token string">&apos;D&apos;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre></details>
<br>
<p>The boxplot function cannot accept a whole Dataframe. The code</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">&apos;ABCDE&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>boxplot<span class="token punctuation">(</span>df<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><p>will not produce the results wanted.</p>
<p>In earlier versions of matplotlib, this code used to fail with an error, now it does produce a result but clearly not what we were hoping for.</p>
<p>Rather than trying to fix this code we can use the pandas plot method instead.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">&apos;ABCDE&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind <span class="token operator">=</span> <span class="token string">&apos;box&apos;</span><span class="token punctuation">)</span> 
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><p>We can add a title to the above by adding the <code>title</code> parameter. However there are no parameters for adding the axis labels.<br>
To add labels we can use matplotlib directly.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">&apos;ABCDE&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind <span class="token operator">=</span> <span class="token string">&apos;box&apos;</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&apos;Box Plot&apos;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&apos;x label&apos;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&apos;y label&apos;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><h2 class="mume-header" id="saving-a-graph">Saving a graph</h2>

<p>If you wish to save your graph as an image you can do so using the <code>savefig()</code> function. The image can be saved as a pdf, jpg or png file by changing the file extension.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>normal<span class="token punctuation">(</span>size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token string">&apos;ABCDE&apos;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind <span class="token operator">=</span> <span class="token string">&apos;box&apos;</span><span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">&apos;Box Plot&apos;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">&apos;x label&apos;</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">&apos;y label&apos;</span><span class="token punctuation">)</span>
<span class="token comment">#plt.show()</span>
plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">&apos;boxplot_from_df.pdf&apos;</span><span class="token punctuation">)</span>
</pre><h2 class="mume-header" id="introducing-the-mysql-connector-module">Introducing the mysql-connector module</h2>

<p>MySQL is a relational database system. MySQL is the most popularly used opensource (FREE) relational database in use. It is used in many, many commercial environments. Like most major Database systems it essentially comes in two halves:</p>
<ul>
<li>The database Engine which manages the storage of the tables which make up a database as well as interpreting user queries and returning the required data and</li>
<li>an interface to allow users to create queries to send to the engine and recieve the results typically in some kind of tabular foramt.</li>
</ul>
<p>It is the first of thes which defines the database type. The second is almost optional, except that all of the major database providers will offer some sort of GUI (Graphical User Interface) program to perform these functions along with other functions related to the management and administration of the database.</p>
<p>Because there is this clear seperation between the database engine and the means to control it, 3rd party vendors are able to provide their own alternatives to the GUI. In fact the alternative doesn&apos;t even have to be a GUI. For programming languages such as Python or R it can simply be another library or package.</p>
<p>For Python to talk to a MySQL database we use the <code>mysql-connector</code> package. This can be installed like any other Python package using <code>pip</code></p>
<pre data-role="codeBlock" data-info="bash" class="language-bash">pip <span class="token function">install</span> mysql-connector 
</pre><p>The mysql-conector package allows users to <code>run</code> any legitiamate SQL command or query. We will use a couple of these commands just to find our way around our database, but in general when  using Python code to access any database, most of what you will want to be doing is having an SQL query executed and the resulting table returned to your Python program. What you then do is up to you but again, much of the time you will return the table to a pandas dataframe.</p>
<h2 class="mume-header" id="pandas-dataframe-v-sql-table">Pandas Dataframe v SQL table</h2>

<p>It is very easy and often very convenient to think of SQL tables and pandas Dataframes as being similar types of objects. All of the data manipulations, slicing, dicing, aggragetions and joins associated with SQL and SQL tables can all be accomplished with pandas methods operating on a pandas Dataframe.</p>
<p>The difference is that the pandas Dataframe is held in memory within the Python environment. The SQL table can largely be on disc and when you access it, it is the MySQL database engine which is doing the work. This allows you to work with very large tables which your Python environment may not have the memory to hold completely.</p>
<p>A typical use case for MySQL databases is to hold large datasets, you use SQL commands from Python to slice and dice and possibly aggregate the data within the database system to reduce the size to something that Python can comfortably process and then return the results to a Dataframe.</p>
<h2 class="mume-header" id="accessing-data-stored-in-mysql-using-python">Accessing data stored in MySQL using Python</h2>

<p>We will illustrate the use of the <code>mysql-connector</code> module by connecting to a MySQL database using both core Python and also using pandas.</p>
<p>We will use the <code>safi</code> database which contains three tables <code>farms</code>, <code>plots</code> and <code>crops</code>. They have been created from the same .csv files that we  have been using previously.</p>
<h2 class="mume-header" id="connecting-to-a-mysql-database">Connecting to a MySQL database</h2>

<p>The first thing we need to do is import the <code>mysql-connector</code> library, We will import pandas at the same time for convenience.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token comment"># Notice the slight change in the module name compared with the package</span>
<span class="token comment"># name given to pip</span>

<span class="token keyword">import</span> mysql<span class="token punctuation">.</span>connector
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
</pre><p>We will start looking at the mysql.connector library by connecting to the <code>safi</code> database. Initially we will do this without using Pandas and then we will repreat the exercise so that you can see the difference.</p>
<p>The first thing we need to do is to make a connection to the database. To do this we use the <code>connect</code> method.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">mydb <span class="token operator">=</span> mysql<span class="token punctuation">.</span>connector<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>
  host<span class="token operator">=</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
  user<span class="token operator">=</span><span class="token string">&quot;your-user&quot;</span><span class="token punctuation">,</span>
  passwd<span class="token operator">=</span><span class="token string">&quot;your-password&quot;</span><span class="token punctuation">,</span>
  database<span class="token operator">=</span><span class="token string">&quot;safi&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>mydb<span class="token punctuation">)</span>
</pre><p>** Things to note **</p>
<ol>
<li>The <code>host</code> paramter specifies the MySQL system (not database) you want to conect to. <code>localhost</code> refers to the default MySQL system on your local machine. Quite often the value here will be a URL pointing to a MySQL system running on a server somewhere.</li>
<li><code>user</code> and <code>password</code> relate to your username and password as defined on the MySQL system you are trying to access.</li>
<li><code>database</code> refers to the database you wish to access. This is in fact optional as we can specifiy the database we wish to access later. But bear in mind that a MySQL system could contain many differentr databases and as it is likely you will only be interested in one within a single python program, specifying it in the connect method aids documentation.</li>
<li>The <code>connection</code> is always assigned to a variable (object) as we need to use it everytime we communicate with the database.</li>
<li>The <code>print</code> statement at the end is just to show that we haqve created a connection object successfully.</li>
</ol>
<p>The next thing we need to do is to create a <code>cursor</code> for the connection and assign it to a variable. We do this using the <code>cursor</code> method of the connection object.</p>
<p>The cursor allows us to pass SQL statements to the database, have them executed and then get the results back.</p>
<p>To execute an SQL statement we use the <code>execute()</code> method of the cursor object.</p>
<p>The only paramater we need to pass to <code>execute()</code> is a string which contains the SQL command or query we wish to execute.</p>
<p>We will start off by listing the tables in our <code>safi</code> database;</p>
<pre data-role="codeBlock" data-info="python" class="language-python">mycursor <span class="token operator">=</span> mydb<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>

mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span><span class="token string">&quot;show tables&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> x <span class="token keyword">in</span> mycursor<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</pre><p>In our example we are passing a literal string. It could have been contained in a string variable. The string can contain any valid SQL statement or query. It could also be a valid DDL statement such as a &quot;CREATE TABLE ...&quot;. In this lesson however we will confine ourseleves to querying existing database tables.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">sql <span class="token operator">=</span> <span class="token string">&quot;select * from crops limit 10&quot;</span>
mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>

<span class="token keyword">for</span> x <span class="token keyword">in</span> mycursor<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>
</pre><p>The <code>sql</code> variable is assigned a string literal which is a valid SQL query asking for the first 10 rows of the <code>crops</code> table to be reurned. You can see from the output from the <code>print</code> statement that the output sent back from the MySQL database engine is interpreted as a list of python tuples. Each tuple containing one row of the data.</p>
<h2 class="mume-header" id="exercise-19">Exercise</h2>

<p>What happens if you if you ask for a non existent table?, field within a table? or just any kind of syntax error?</p>
<details><summary><b>Solution</b>  - click me</summary>
<pre data-role="codeBlock" data-info="python" class="language-python">sql <span class="token operator">=</span> <span class="token string">&quot;select * from crops limit 10&quot;</span>
mycursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
</pre><p>In all cases an error message is returned. The error message is not from Python but from MySQL. It is the same error message that you would have got had you made the same errors in the MySQL Workbench (or any other MySQL GUI).</p>
</details>
<br>
<h2 class="mume-header" id="using-pandas-to-read-a-database-table">Using Pandas to read a database table.</h2>

<p>To use pandas with MySQL we still need to use the mysql.connector library for the connection and of course we need to load the pandas library as well.</p>
<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token keyword">import</span> mysql<span class="token punctuation">.</span>connector
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
mydb <span class="token operator">=</span> mysql<span class="token punctuation">.</span>connector<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>
  host<span class="token operator">=</span><span class="token string">&quot;localhost&quot;</span><span class="token punctuation">,</span>
  user<span class="token operator">=</span><span class="token string">&quot;your-user&quot;</span><span class="token punctuation">,</span>
  passwd<span class="token operator">=</span><span class="token string">&quot;your-password&quot;</span><span class="token punctuation">,</span>
  database<span class="token operator">=</span><span class="token string">&quot;safi&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>mydb<span class="token punctuation">)</span>
</pre><p>We can then run queries directly using the <code>read_sql</code> method. We don&apos;t need to create the cursor ourselves.</p>
<pre data-role="codeBlock" data-info="python" class="language-python">sql <span class="token operator">=</span> <span class="token string">&quot;select * from farms&quot;</span>
df_farms <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> mydb<span class="token punctuation">)</span>
df_farms<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><p>The entire table is returned and stored in the <code>df_farms</code> dataframe.</p>
<p>The sql statement can be any kind of <code>select</code> statement. If we want to use a where clause...</p>
<pre data-role="codeBlock" data-info="python" class="language-python">sql <span class="token operator">=</span> <span class="token string">&quot;select * from farms where A06_province = &apos;Nampula&apos;&quot;</span>
df_farms <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> mydb<span class="token punctuation">)</span>
df_farms<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><p>If we are using <code>where</code> clauses it is likely that we may want to parameterised the query</p>
<pre data-role="codeBlock" data-info="python" class="language-python">sql <span class="token operator">=</span> <span class="token string">&quot;select * from farms where B_no_membrs &gt; %s &quot;</span>
fam_size <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span>
df_farms <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> mydb<span class="token punctuation">,</span> params <span class="token operator">=</span> fam_size<span class="token punctuation">)</span>
df_farms<span class="token punctuation">.</span>shape
</pre><p>The <code>%s</code> is standard python string formatting. We want the <code>%s</code> to be replaced with the value 12. The parameter is included in the <code>read.sql</code> method using the <code>params</code> parameter. But this needs to be a list so we make <code>fam-size</code> a list even though it has only one value.</p>
<p>This type of substitution deos not work if you are trying to parameterise a table name. However if you wanted to know how many rows are in each of the database tables you could use code like this</p>
<pre data-role="codeBlock" data-info="python" class="language-python">df_tables <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">&quot;Show Tables&quot;</span><span class="token punctuation">,</span>mydb<span class="token punctuation">)</span>

<span class="token keyword">for</span> x <span class="token keyword">in</span> df_tables<span class="token punctuation">[</span><span class="token string">&apos;Tables_in_safi&apos;</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    sql <span class="token operator">=</span> <span class="token string">&quot;select count(*) row_count from &quot;</span> <span class="token operator">+</span> x
    row_count <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span>sql<span class="token punctuation">,</span> mydb<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;There are %s rows in table %s&quot;</span> <span class="token operator">%</span> <span class="token punctuation">(</span>row_count<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span>

</pre>
      </div>
      
      
    
    
    
    
    
    
    
    
  
    </body></html>